/*
 * This file is auto-generated by Chargebee.
 * Copyright 2025 Chargebee Inc.
 */

package com.chargebee.v4.filters;

import java.util.Map;

/**
 * Filter for string fields supporting is, isNot, startsWith, in, notIn, isPresent operations.
 *
 * @param <B> The builder type to return for method chaining
 */
public class StringFilter<B> {

  protected final String fieldName;
  protected final B builder;
  protected final Map<String, Object> params;
  private boolean supportsMultiOperators = true;
  private boolean supportsPresenceOperator = true;

  public StringFilter(String fieldName, B builder, Map<String, Object> params) {
    this.fieldName = fieldName;
    this.builder = builder;
    this.params = params;
  }

  public StringFilter<B> supportsMultiOperators(boolean supportsMultiOperators) {
    this.supportsMultiOperators = supportsMultiOperators;
    return this;
  }

  public StringFilter<B> supportsPresenceOperator(boolean supportsPresenceOperator) {
    this.supportsPresenceOperator = supportsPresenceOperator;
    return this;
  }

  public B is(String value) {
    params.put(fieldName + "[is]", value);
    return builder;
  }

  public B isNot(String value) {
    params.put(fieldName + "[is_not]", value);
    return builder;
  }

  public B startsWith(String value) {
    params.put(fieldName + "[starts_with]", value);
    return builder;
  }

  public B isPresent(boolean value) {
    if (!supportsPresenceOperator) {
      throw new UnsupportedOperationException(
          "operator '[is_present]' is not supported for this filter-parameter");
    }
    params.put(fieldName + "[is_present]", String.valueOf(value));
    return builder;
  }

  public B in(String... values) {
    if (!supportsMultiOperators) {
      throw new UnsupportedOperationException(
          "operator '[in]' is not supported for this filter-parameter");
    }
    params.put(fieldName + "[in]", "[" + String.join(",", values) + "]");
    return builder;
  }

  public B notIn(String... values) {
    if (!supportsMultiOperators) {
      throw new UnsupportedOperationException(
          "operator '[not_in]' is not supported for this filter-parameter");
    }
    params.put(fieldName + "[not_in]", "[" + String.join(",", values) + "]");
    return builder;
  }
}

