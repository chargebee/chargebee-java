/*
 * This file is auto-generated by Chargebee.
 * Copyright 2025 Chargebee Inc.
 */

package com.chargebee.v4.filters;

import java.sql.Timestamp;
import java.util.Map;

/**
 * Filter for timestamp fields supporting on, before, after, between operations.
 *
 * @param <B> The builder type to return for method chaining
 */
public class TimestampFilter<B> {

  protected final String fieldName;
  protected final B builder;
  protected final Map<String, Object> params;
  private boolean supportsPresenceOperator = false;

  public TimestampFilter(String fieldName, B builder, Map<String, Object> params) {
    this.fieldName = fieldName;
    this.builder = builder;
    this.params = params;
  }

  public TimestampFilter<B> supportsPresenceOperator(boolean supportsPresenceOperator) {
    this.supportsPresenceOperator = supportsPresenceOperator;
    return this;
  }

  public B on(Timestamp value) {
    params.put(fieldName + "[on]", value.getTime() / 1000);
    return builder;
  }

  public B before(Timestamp value) {
    params.put(fieldName + "[before]", value.getTime() / 1000);
    return builder;
  }

  public B after(Timestamp value) {
    params.put(fieldName + "[after]", value.getTime() / 1000);
    return builder;
  }

  public B between(Timestamp start, Timestamp end) {
    params.put(
        fieldName + "[between]",
        "[" + (start.getTime() / 1000) + "," + (end.getTime() / 1000) + "]");
    return builder;
  }

  public B isPresent(boolean value) {
    if (!supportsPresenceOperator) {
      throw new UnsupportedOperationException(
          "operator '[is_present]' is not supported for this filter-parameter");
    }
    params.put(fieldName + "[is_present]", String.valueOf(value));
    return builder;
  }
}

