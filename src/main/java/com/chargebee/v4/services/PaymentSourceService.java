/*
 * This file is auto-generated by Chargebee.
 * For more information on how to make changes to this file, please see the README.
 * Reach out to dx@chargebee.com for any questions.
 * Copyright 2025 Chargebee Inc.
 */

package com.chargebee.v4.services;

import com.chargebee.v4.client.ChargebeeClient;
import com.chargebee.v4.client.request.RequestOptions;
import com.chargebee.v4.transport.Response;

import com.chargebee.v4.models.paymentSource.params.PaymentSourceCreateUsingPermanentTokenParams;

import com.chargebee.v4.models.paymentSource.params.PaymentSourceCreateCardParams;

import com.chargebee.v4.models.paymentSource.params.VerifyBankAccountForPaymentSourceParams;

import com.chargebee.v4.models.paymentSource.params.PaymentSourceListParams;

import com.chargebee.v4.models.paymentSource.params.ExportPaymentSourceForPaymentSourceParams;

import com.chargebee.v4.models.paymentSource.params.PaymentSourceCreateUsingPaymentIntentParams;

import com.chargebee.v4.models.paymentSource.params.CreateVoucherPaymentSourceParams;

import com.chargebee.v4.models.paymentSource.params.PaymentSourceCreateUsingTempTokenParams;

import com.chargebee.v4.models.paymentSource.params.UpdateCardForPaymentSourceParams;

import com.chargebee.v4.models.paymentSource.params.SwitchGatewayAccountForPaymentSourceParams;

import com.chargebee.v4.models.paymentSource.params.PaymentSourceCreateUsingTokenParams;

import com.chargebee.v4.models.paymentSource.params.PaymentSourceCreateBankAccountParams;

import com.chargebee.v4.models.paymentSource.params.UpdateBankAccountForPaymentSourceParams;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceCreateUsingPermanentTokenResponse;

import com.chargebee.v4.models.paymentSource.responses.DeletePaymentSourceResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceCreateCardResponse;

import com.chargebee.v4.models.paymentSource.responses.VerifyBankAccountForPaymentSourceResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceListResponse;

import com.chargebee.v4.models.paymentSource.responses.ExportPaymentSourceForPaymentSourceResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceCreateUsingPaymentIntentResponse;

import com.chargebee.v4.models.paymentSource.responses.AgreementPdfForPaymentSourceResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceRetrieveResponse;

import com.chargebee.v4.models.paymentSource.responses.CreateVoucherPaymentSourceResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceCreateUsingTempTokenResponse;

import com.chargebee.v4.models.paymentSource.responses.UpdateCardForPaymentSourceResponse;

import com.chargebee.v4.models.paymentSource.responses.SwitchGatewayAccountForPaymentSourceResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceCreateUsingTokenResponse;

import com.chargebee.v4.models.paymentSource.responses.DeleteLocalForPaymentSourceResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceCreateBankAccountResponse;

import com.chargebee.v4.models.paymentSource.responses.UpdateBankAccountForPaymentSourceResponse;

public final class PaymentSourceService extends BaseService<PaymentSourceService> {

  private final ServiceConfig config;

  public PaymentSourceService(ChargebeeClient client) {
    super(client);
    this.config = ServiceConfig.defaultConfig();
  }

  private PaymentSourceService(ChargebeeClient client, RequestOptions options) {
    super(client, options);
    this.config = ServiceConfig.defaultConfig();
  }

  private PaymentSourceService(
      ChargebeeClient client, RequestOptions options, ServiceConfig config) {
    super(client, options);
    this.config = config;
  }

  @Override
  PaymentSourceService with(RequestOptions newOptions) {
    return new PaymentSourceService(client, newOptions, config);
  }

  /**
   * Apply per-request options for this service instance. Users can chain .withOptions or .options
   * to set headers and other options.
   */
  public PaymentSourceService withOptions(RequestOptions options) {
    return with(options);
  }

  // === Operations ===

  /**
   * createUsingPermanentToken a paymentSource using immutable params (executes immediately) -
   * returns raw Response.
   */
  Response createUsingPermanentTokenRaw(PaymentSourceCreateUsingPermanentTokenParams params)
      throws Exception {

    return post(
        "/payment_sources/create_using_permanent_token",
        params != null ? params.toFormData() : null);
  }

  /**
   * createUsingPermanentToken a paymentSource using raw JSON payload (executes immediately) -
   * returns raw Response.
   */
  Response createUsingPermanentTokenRaw(String jsonPayload) throws Exception {

    return postJson("/payment_sources/create_using_permanent_token", jsonPayload);
  }

  public PaymentSourceCreateUsingPermanentTokenResponse createUsingPermanentToken(
      PaymentSourceCreateUsingPermanentTokenParams params) throws Exception {
    Response response = createUsingPermanentTokenRaw(params);

    return PaymentSourceCreateUsingPermanentTokenResponse.fromJson(
        response.getBodyAsString(), response);
  }

  /** deletePaymentSource a paymentSource (executes immediately) - returns raw Response. */
  Response deletePaymentSourceRaw(String custPaymentSourceId) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/delete",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  public DeletePaymentSourceResponse deletePaymentSource(String custPaymentSourceId)
      throws Exception {
    Response response = deletePaymentSourceRaw(custPaymentSourceId);
    return DeletePaymentSourceResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * createCard a paymentSource using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response createCardRaw(PaymentSourceCreateCardParams params) throws Exception {

    return post("/payment_sources/create_card", params != null ? params.toFormData() : null);
  }

  /**
   * createCard a paymentSource using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response createCardRaw(String jsonPayload) throws Exception {

    return postJson("/payment_sources/create_card", jsonPayload);
  }

  public PaymentSourceCreateCardResponse createCard(PaymentSourceCreateCardParams params)
      throws Exception {
    Response response = createCardRaw(params);

    return PaymentSourceCreateCardResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * verifyBankAccountForPaymentSource a paymentSource (executes immediately) - returns raw
   * Response.
   */
  Response verifyBankAccountForPaymentSourceRaw(String custPaymentSourceId) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/verify_bank_account",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  /**
   * verifyBankAccountForPaymentSource a paymentSource using immutable params (executes immediately)
   * - returns raw Response.
   */
  Response verifyBankAccountForPaymentSourceRaw(
      String custPaymentSourceId, VerifyBankAccountForPaymentSourceParams params) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/verify_bank_account",
            "cust-payment-source-id",
            custPaymentSourceId);
    return post(path, params.toFormData());
  }

  /**
   * verifyBankAccountForPaymentSource a paymentSource using raw JSON payload (executes immediately)
   * - returns raw Response.
   */
  Response verifyBankAccountForPaymentSourceRaw(String custPaymentSourceId, String jsonPayload)
      throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/verify_bank_account",
            "cust-payment-source-id",
            custPaymentSourceId);
    return postJson(path, jsonPayload);
  }

  public VerifyBankAccountForPaymentSourceResponse verifyBankAccountForPaymentSource(
      String custPaymentSourceId, VerifyBankAccountForPaymentSourceParams params) throws Exception {
    Response response = verifyBankAccountForPaymentSourceRaw(custPaymentSourceId, params);
    return VerifyBankAccountForPaymentSourceResponse.fromJson(response.getBodyAsString(), response);
  }

  /** list a paymentSource using immutable params (executes immediately) - returns raw Response. */
  Response listRaw(PaymentSourceListParams params) throws Exception {

    return get("/payment_sources", params != null ? params.toQueryParams() : null);
  }

  /** list a paymentSource without params (executes immediately) - returns raw Response. */
  Response listRaw() throws Exception {

    return get("/payment_sources", null);
  }

  /** list a paymentSource using raw JSON payload (executes immediately) - returns raw Response. */
  Response listRaw(String jsonPayload) throws Exception {

    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public PaymentSourceListResponse list(PaymentSourceListParams params) throws Exception {
    Response response = listRaw(params);

    return PaymentSourceListResponse.fromJson(response.getBodyAsString(), this, params, response);
  }

  public PaymentSourceListResponse list() throws Exception {
    Response response = listRaw();
    return PaymentSourceListResponse.fromJson(response.getBodyAsString(), this, null, response);
  }

  /**
   * exportPaymentSourceForPaymentSource a paymentSource (executes immediately) - returns raw
   * Response.
   */
  Response exportPaymentSourceForPaymentSourceRaw(String custPaymentSourceId) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/export_payment_source",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  /**
   * exportPaymentSourceForPaymentSource a paymentSource using immutable params (executes
   * immediately) - returns raw Response.
   */
  Response exportPaymentSourceForPaymentSourceRaw(
      String custPaymentSourceId, ExportPaymentSourceForPaymentSourceParams params)
      throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/export_payment_source",
            "cust-payment-source-id",
            custPaymentSourceId);
    return post(path, params.toFormData());
  }

  /**
   * exportPaymentSourceForPaymentSource a paymentSource using raw JSON payload (executes
   * immediately) - returns raw Response.
   */
  Response exportPaymentSourceForPaymentSourceRaw(String custPaymentSourceId, String jsonPayload)
      throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/export_payment_source",
            "cust-payment-source-id",
            custPaymentSourceId);
    return postJson(path, jsonPayload);
  }

  public ExportPaymentSourceForPaymentSourceResponse exportPaymentSourceForPaymentSource(
      String custPaymentSourceId, ExportPaymentSourceForPaymentSourceParams params)
      throws Exception {
    Response response = exportPaymentSourceForPaymentSourceRaw(custPaymentSourceId, params);
    return ExportPaymentSourceForPaymentSourceResponse.fromJson(
        response.getBodyAsString(), response);
  }

  /**
   * createUsingPaymentIntent a paymentSource using immutable params (executes immediately) -
   * returns raw Response.
   */
  Response createUsingPaymentIntentRaw(PaymentSourceCreateUsingPaymentIntentParams params)
      throws Exception {

    return post(
        "/payment_sources/create_using_payment_intent",
        params != null ? params.toFormData() : null);
  }

  /**
   * createUsingPaymentIntent a paymentSource using raw JSON payload (executes immediately) -
   * returns raw Response.
   */
  Response createUsingPaymentIntentRaw(String jsonPayload) throws Exception {

    return postJson("/payment_sources/create_using_payment_intent", jsonPayload);
  }

  public PaymentSourceCreateUsingPaymentIntentResponse createUsingPaymentIntent(
      PaymentSourceCreateUsingPaymentIntentParams params) throws Exception {
    Response response = createUsingPaymentIntentRaw(params);

    return PaymentSourceCreateUsingPaymentIntentResponse.fromJson(
        response.getBodyAsString(), response);
  }

  /** agreementPdfForPaymentSource a paymentSource (executes immediately) - returns raw Response. */
  Response agreementPdfForPaymentSourceRaw(String custPaymentSourceId) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/agreement_pdf",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  public AgreementPdfForPaymentSourceResponse agreementPdfForPaymentSource(
      String custPaymentSourceId) throws Exception {
    Response response = agreementPdfForPaymentSourceRaw(custPaymentSourceId);
    return AgreementPdfForPaymentSourceResponse.fromJson(response.getBodyAsString(), response);
  }

  /** retrieve a paymentSource (executes immediately) - returns raw Response. */
  Response retrieveRaw(String custPaymentSourceId) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}",
            "cust-payment-source-id",
            custPaymentSourceId);

    return get(path, null);
  }

  public PaymentSourceRetrieveResponse retrieve(String custPaymentSourceId) throws Exception {
    Response response = retrieveRaw(custPaymentSourceId);
    return PaymentSourceRetrieveResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * createVoucherPaymentSource a paymentSource using immutable params (executes immediately) -
   * returns raw Response.
   */
  Response createVoucherPaymentSourceRaw(CreateVoucherPaymentSourceParams params) throws Exception {

    return post(
        "/payment_sources/create_voucher_payment_source",
        params != null ? params.toFormData() : null);
  }

  /**
   * createVoucherPaymentSource a paymentSource using raw JSON payload (executes immediately) -
   * returns raw Response.
   */
  Response createVoucherPaymentSourceRaw(String jsonPayload) throws Exception {

    return postJson("/payment_sources/create_voucher_payment_source", jsonPayload);
  }

  public CreateVoucherPaymentSourceResponse createVoucherPaymentSource(
      CreateVoucherPaymentSourceParams params) throws Exception {
    Response response = createVoucherPaymentSourceRaw(params);

    return CreateVoucherPaymentSourceResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * createUsingTempToken a paymentSource using immutable params (executes immediately) - returns
   * raw Response.
   */
  Response createUsingTempTokenRaw(PaymentSourceCreateUsingTempTokenParams params)
      throws Exception {

    return post(
        "/payment_sources/create_using_temp_token", params != null ? params.toFormData() : null);
  }

  /**
   * createUsingTempToken a paymentSource using raw JSON payload (executes immediately) - returns
   * raw Response.
   */
  Response createUsingTempTokenRaw(String jsonPayload) throws Exception {

    return postJson("/payment_sources/create_using_temp_token", jsonPayload);
  }

  public PaymentSourceCreateUsingTempTokenResponse createUsingTempToken(
      PaymentSourceCreateUsingTempTokenParams params) throws Exception {
    Response response = createUsingTempTokenRaw(params);

    return PaymentSourceCreateUsingTempTokenResponse.fromJson(response.getBodyAsString(), response);
  }

  /** updateCardForPaymentSource a paymentSource (executes immediately) - returns raw Response. */
  Response updateCardForPaymentSourceRaw(String custPaymentSourceId) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/update_card",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  /**
   * updateCardForPaymentSource a paymentSource using immutable params (executes immediately) -
   * returns raw Response.
   */
  Response updateCardForPaymentSourceRaw(
      String custPaymentSourceId, UpdateCardForPaymentSourceParams params) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/update_card",
            "cust-payment-source-id",
            custPaymentSourceId);
    return post(path, params.toFormData());
  }

  /**
   * updateCardForPaymentSource a paymentSource using raw JSON payload (executes immediately) -
   * returns raw Response.
   */
  Response updateCardForPaymentSourceRaw(String custPaymentSourceId, String jsonPayload)
      throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/update_card",
            "cust-payment-source-id",
            custPaymentSourceId);
    return postJson(path, jsonPayload);
  }

  public UpdateCardForPaymentSourceResponse updateCardForPaymentSource(
      String custPaymentSourceId, UpdateCardForPaymentSourceParams params) throws Exception {
    Response response = updateCardForPaymentSourceRaw(custPaymentSourceId, params);
    return UpdateCardForPaymentSourceResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * switchGatewayAccountForPaymentSource a paymentSource (executes immediately) - returns raw
   * Response.
   */
  Response switchGatewayAccountForPaymentSourceRaw(String custPaymentSourceId) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/switch_gateway_account",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  /**
   * switchGatewayAccountForPaymentSource a paymentSource using immutable params (executes
   * immediately) - returns raw Response.
   */
  Response switchGatewayAccountForPaymentSourceRaw(
      String custPaymentSourceId, SwitchGatewayAccountForPaymentSourceParams params)
      throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/switch_gateway_account",
            "cust-payment-source-id",
            custPaymentSourceId);
    return post(path, params.toFormData());
  }

  /**
   * switchGatewayAccountForPaymentSource a paymentSource using raw JSON payload (executes
   * immediately) - returns raw Response.
   */
  Response switchGatewayAccountForPaymentSourceRaw(String custPaymentSourceId, String jsonPayload)
      throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/switch_gateway_account",
            "cust-payment-source-id",
            custPaymentSourceId);
    return postJson(path, jsonPayload);
  }

  public SwitchGatewayAccountForPaymentSourceResponse switchGatewayAccountForPaymentSource(
      String custPaymentSourceId, SwitchGatewayAccountForPaymentSourceParams params)
      throws Exception {
    Response response = switchGatewayAccountForPaymentSourceRaw(custPaymentSourceId, params);
    return SwitchGatewayAccountForPaymentSourceResponse.fromJson(
        response.getBodyAsString(), response);
  }

  /**
   * createUsingToken a paymentSource using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response createUsingTokenRaw(PaymentSourceCreateUsingTokenParams params) throws Exception {

    return post("/payment_sources/create_using_token", params != null ? params.toFormData() : null);
  }

  /**
   * createUsingToken a paymentSource using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response createUsingTokenRaw(String jsonPayload) throws Exception {

    return postJson("/payment_sources/create_using_token", jsonPayload);
  }

  public PaymentSourceCreateUsingTokenResponse createUsingToken(
      PaymentSourceCreateUsingTokenParams params) throws Exception {
    Response response = createUsingTokenRaw(params);

    return PaymentSourceCreateUsingTokenResponse.fromJson(response.getBodyAsString(), response);
  }

  /** deleteLocalForPaymentSource a paymentSource (executes immediately) - returns raw Response. */
  Response deleteLocalForPaymentSourceRaw(String custPaymentSourceId) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/delete_local",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  public DeleteLocalForPaymentSourceResponse deleteLocalForPaymentSource(String custPaymentSourceId)
      throws Exception {
    Response response = deleteLocalForPaymentSourceRaw(custPaymentSourceId);
    return DeleteLocalForPaymentSourceResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * createBankAccount a paymentSource using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response createBankAccountRaw(PaymentSourceCreateBankAccountParams params) throws Exception {

    return post(
        "/payment_sources/create_bank_account", params != null ? params.toFormData() : null);
  }

  /**
   * createBankAccount a paymentSource using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response createBankAccountRaw(String jsonPayload) throws Exception {

    return postJson("/payment_sources/create_bank_account", jsonPayload);
  }

  public PaymentSourceCreateBankAccountResponse createBankAccount(
      PaymentSourceCreateBankAccountParams params) throws Exception {
    Response response = createBankAccountRaw(params);

    return PaymentSourceCreateBankAccountResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * updateBankAccountForPaymentSource a paymentSource (executes immediately) - returns raw
   * Response.
   */
  Response updateBankAccountForPaymentSourceRaw(String custPaymentSourceId) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/update_bank_account",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  /**
   * updateBankAccountForPaymentSource a paymentSource using immutable params (executes immediately)
   * - returns raw Response.
   */
  Response updateBankAccountForPaymentSourceRaw(
      String custPaymentSourceId, UpdateBankAccountForPaymentSourceParams params) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/update_bank_account",
            "cust-payment-source-id",
            custPaymentSourceId);
    return post(path, params.toFormData());
  }

  /**
   * updateBankAccountForPaymentSource a paymentSource using raw JSON payload (executes immediately)
   * - returns raw Response.
   */
  Response updateBankAccountForPaymentSourceRaw(String custPaymentSourceId, String jsonPayload)
      throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/update_bank_account",
            "cust-payment-source-id",
            custPaymentSourceId);
    return postJson(path, jsonPayload);
  }

  public UpdateBankAccountForPaymentSourceResponse updateBankAccountForPaymentSource(
      String custPaymentSourceId, UpdateBankAccountForPaymentSourceParams params) throws Exception {
    Response response = updateBankAccountForPaymentSourceRaw(custPaymentSourceId, params);
    return UpdateBankAccountForPaymentSourceResponse.fromJson(response.getBodyAsString(), response);
  }
}
