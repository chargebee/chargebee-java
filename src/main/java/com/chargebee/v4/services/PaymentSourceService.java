/*
 * This file is auto-generated by Chargebee.
 * For more information on how to make changes to this file, please see the README.
 * Reach out to dx@chargebee.com for any questions.
 * Copyright 2025 Chargebee Inc.
 */

package com.chargebee.v4.services;

import com.chargebee.v4.client.ChargebeeClient;
import com.chargebee.v4.client.request.RequestOptions;
import com.chargebee.v4.exceptions.ChargebeeException;
import com.chargebee.v4.transport.Response;

import com.chargebee.v4.models.paymentSource.params.PaymentSourceCreateUsingPermanentTokenParams;

import com.chargebee.v4.models.paymentSource.params.PaymentSourceCreateCardParams;

import com.chargebee.v4.models.paymentSource.params.PaymentSourceVerifyBankAccountParams;

import com.chargebee.v4.models.paymentSource.params.PaymentSourceListParams;

import com.chargebee.v4.models.paymentSource.params.ExportPaymentSourceParams;

import com.chargebee.v4.models.paymentSource.params.PaymentSourceCreateUsingPaymentIntentParams;

import com.chargebee.v4.models.paymentSource.params.CreateVoucherPaymentSourceParams;

import com.chargebee.v4.models.paymentSource.params.PaymentSourceCreateUsingTempTokenParams;

import com.chargebee.v4.models.paymentSource.params.PaymentSourceUpdateCardParams;

import com.chargebee.v4.models.paymentSource.params.PaymentSourceSwitchGatewayAccountParams;

import com.chargebee.v4.models.paymentSource.params.PaymentSourceCreateUsingTokenParams;

import com.chargebee.v4.models.paymentSource.params.PaymentSourceCreateBankAccountParams;

import com.chargebee.v4.models.paymentSource.params.PaymentSourceUpdateBankAccountParams;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceCreateUsingPermanentTokenResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceDeleteResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceCreateCardResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceVerifyBankAccountResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceListResponse;

import com.chargebee.v4.models.paymentSource.responses.ExportPaymentSourceResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceCreateUsingPaymentIntentResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceAgreementPdfResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceRetrieveResponse;

import com.chargebee.v4.models.paymentSource.responses.CreateVoucherPaymentSourceResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceCreateUsingTempTokenResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceUpdateCardResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceSwitchGatewayAccountResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceCreateUsingTokenResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceDeleteLocalResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceCreateBankAccountResponse;

import com.chargebee.v4.models.paymentSource.responses.PaymentSourceUpdateBankAccountResponse;

public final class PaymentSourceService extends BaseService<PaymentSourceService> {

  private final ServiceConfig config;

  public PaymentSourceService(ChargebeeClient client) {
    super(client);
    this.config = ServiceConfig.defaultConfig();
  }

  private PaymentSourceService(ChargebeeClient client, RequestOptions options) {
    super(client, options);
    this.config = ServiceConfig.defaultConfig();
  }

  private PaymentSourceService(
      ChargebeeClient client, RequestOptions options, ServiceConfig config) {
    super(client, options);
    this.config = config;
  }

  @Override
  PaymentSourceService with(RequestOptions newOptions) {
    return new PaymentSourceService(client, newOptions, config);
  }

  /**
   * Apply per-request options for this service instance. Users can chain .withOptions or .options
   * to set headers and other options.
   */
  public PaymentSourceService withOptions(RequestOptions options) {
    return with(options);
  }

  // === Operations ===

  /**
   * createUsingPermanentToken a paymentSource using immutable params (executes immediately) -
   * returns raw Response.
   */
  Response createUsingPermanentTokenRaw(PaymentSourceCreateUsingPermanentTokenParams params)
      throws ChargebeeException {

    return post(
        "/payment_sources/create_using_permanent_token",
        params != null ? params.toFormData() : null);
  }

  /**
   * createUsingPermanentToken a paymentSource using raw JSON payload (executes immediately) -
   * returns raw Response.
   */
  Response createUsingPermanentTokenRaw(String jsonPayload) throws ChargebeeException {

    return postJson("/payment_sources/create_using_permanent_token", jsonPayload);
  }

  public PaymentSourceCreateUsingPermanentTokenResponse createUsingPermanentToken(
      PaymentSourceCreateUsingPermanentTokenParams params) throws ChargebeeException {
    Response response = createUsingPermanentTokenRaw(params);

    return PaymentSourceCreateUsingPermanentTokenResponse.fromJson(
        response.getBodyAsString(), response);
  }

  /** delete a paymentSource (executes immediately) - returns raw Response. */
  Response deleteRaw(String custPaymentSourceId) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/delete",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  public PaymentSourceDeleteResponse delete(String custPaymentSourceId) throws ChargebeeException {
    Response response = deleteRaw(custPaymentSourceId);
    return PaymentSourceDeleteResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * createCard a paymentSource using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response createCardRaw(PaymentSourceCreateCardParams params) throws ChargebeeException {

    return post("/payment_sources/create_card", params != null ? params.toFormData() : null);
  }

  /**
   * createCard a paymentSource using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response createCardRaw(String jsonPayload) throws ChargebeeException {

    return postJson("/payment_sources/create_card", jsonPayload);
  }

  public PaymentSourceCreateCardResponse createCard(PaymentSourceCreateCardParams params)
      throws ChargebeeException {
    Response response = createCardRaw(params);

    return PaymentSourceCreateCardResponse.fromJson(response.getBodyAsString(), response);
  }

  /** verifyBankAccount a paymentSource (executes immediately) - returns raw Response. */
  Response verifyBankAccountRaw(String custPaymentSourceId) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/verify_bank_account",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  /**
   * verifyBankAccount a paymentSource using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response verifyBankAccountRaw(
      String custPaymentSourceId, PaymentSourceVerifyBankAccountParams params)
      throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/verify_bank_account",
            "cust-payment-source-id",
            custPaymentSourceId);
    return post(path, params.toFormData());
  }

  /**
   * verifyBankAccount a paymentSource using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response verifyBankAccountRaw(String custPaymentSourceId, String jsonPayload)
      throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/verify_bank_account",
            "cust-payment-source-id",
            custPaymentSourceId);
    return postJson(path, jsonPayload);
  }

  public PaymentSourceVerifyBankAccountResponse verifyBankAccount(
      String custPaymentSourceId, PaymentSourceVerifyBankAccountParams params)
      throws ChargebeeException {
    Response response = verifyBankAccountRaw(custPaymentSourceId, params);
    return PaymentSourceVerifyBankAccountResponse.fromJson(response.getBodyAsString(), response);
  }

  /** list a paymentSource using immutable params (executes immediately) - returns raw Response. */
  Response listRaw(PaymentSourceListParams params) throws ChargebeeException {

    return get("/payment_sources", params != null ? params.toQueryParams() : null);
  }

  /** list a paymentSource without params (executes immediately) - returns raw Response. */
  Response listRaw() throws ChargebeeException {

    return get("/payment_sources", null);
  }

  /** list a paymentSource using raw JSON payload (executes immediately) - returns raw Response. */
  Response listRaw(String jsonPayload) throws ChargebeeException {

    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public PaymentSourceListResponse list(PaymentSourceListParams params) throws ChargebeeException {
    Response response = listRaw(params);

    return PaymentSourceListResponse.fromJson(response.getBodyAsString(), this, params, response);
  }

  public PaymentSourceListResponse list() throws ChargebeeException {
    Response response = listRaw();
    return PaymentSourceListResponse.fromJson(response.getBodyAsString(), this, null, response);
  }

  /** exportPaymentSource a paymentSource (executes immediately) - returns raw Response. */
  Response exportPaymentSourceRaw(String custPaymentSourceId) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/export_payment_source",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  /**
   * exportPaymentSource a paymentSource using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response exportPaymentSourceRaw(String custPaymentSourceId, ExportPaymentSourceParams params)
      throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/export_payment_source",
            "cust-payment-source-id",
            custPaymentSourceId);
    return post(path, params.toFormData());
  }

  /**
   * exportPaymentSource a paymentSource using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response exportPaymentSourceRaw(String custPaymentSourceId, String jsonPayload)
      throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/export_payment_source",
            "cust-payment-source-id",
            custPaymentSourceId);
    return postJson(path, jsonPayload);
  }

  public ExportPaymentSourceResponse exportPaymentSource(
      String custPaymentSourceId, ExportPaymentSourceParams params) throws ChargebeeException {
    Response response = exportPaymentSourceRaw(custPaymentSourceId, params);
    return ExportPaymentSourceResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * createUsingPaymentIntent a paymentSource using immutable params (executes immediately) -
   * returns raw Response.
   */
  Response createUsingPaymentIntentRaw(PaymentSourceCreateUsingPaymentIntentParams params)
      throws ChargebeeException {

    return post(
        "/payment_sources/create_using_payment_intent",
        params != null ? params.toFormData() : null);
  }

  /**
   * createUsingPaymentIntent a paymentSource using raw JSON payload (executes immediately) -
   * returns raw Response.
   */
  Response createUsingPaymentIntentRaw(String jsonPayload) throws ChargebeeException {

    return postJson("/payment_sources/create_using_payment_intent", jsonPayload);
  }

  public PaymentSourceCreateUsingPaymentIntentResponse createUsingPaymentIntent(
      PaymentSourceCreateUsingPaymentIntentParams params) throws ChargebeeException {
    Response response = createUsingPaymentIntentRaw(params);

    return PaymentSourceCreateUsingPaymentIntentResponse.fromJson(
        response.getBodyAsString(), response);
  }

  /** agreementPdf a paymentSource (executes immediately) - returns raw Response. */
  Response agreementPdfRaw(String custPaymentSourceId) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/agreement_pdf",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  public PaymentSourceAgreementPdfResponse agreementPdf(String custPaymentSourceId)
      throws ChargebeeException {
    Response response = agreementPdfRaw(custPaymentSourceId);
    return PaymentSourceAgreementPdfResponse.fromJson(response.getBodyAsString(), response);
  }

  /** retrieve a paymentSource (executes immediately) - returns raw Response. */
  Response retrieveRaw(String custPaymentSourceId) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}",
            "cust-payment-source-id",
            custPaymentSourceId);

    return get(path, null);
  }

  public PaymentSourceRetrieveResponse retrieve(String custPaymentSourceId)
      throws ChargebeeException {
    Response response = retrieveRaw(custPaymentSourceId);
    return PaymentSourceRetrieveResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * createVoucherPaymentSource a paymentSource using immutable params (executes immediately) -
   * returns raw Response.
   */
  Response createVoucherPaymentSourceRaw(CreateVoucherPaymentSourceParams params)
      throws ChargebeeException {

    return post(
        "/payment_sources/create_voucher_payment_source",
        params != null ? params.toFormData() : null);
  }

  /**
   * createVoucherPaymentSource a paymentSource using raw JSON payload (executes immediately) -
   * returns raw Response.
   */
  Response createVoucherPaymentSourceRaw(String jsonPayload) throws ChargebeeException {

    return postJson("/payment_sources/create_voucher_payment_source", jsonPayload);
  }

  public CreateVoucherPaymentSourceResponse createVoucherPaymentSource(
      CreateVoucherPaymentSourceParams params) throws ChargebeeException {
    Response response = createVoucherPaymentSourceRaw(params);

    return CreateVoucherPaymentSourceResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * createUsingTempToken a paymentSource using immutable params (executes immediately) - returns
   * raw Response.
   */
  Response createUsingTempTokenRaw(PaymentSourceCreateUsingTempTokenParams params)
      throws ChargebeeException {

    return post(
        "/payment_sources/create_using_temp_token", params != null ? params.toFormData() : null);
  }

  /**
   * createUsingTempToken a paymentSource using raw JSON payload (executes immediately) - returns
   * raw Response.
   */
  Response createUsingTempTokenRaw(String jsonPayload) throws ChargebeeException {

    return postJson("/payment_sources/create_using_temp_token", jsonPayload);
  }

  public PaymentSourceCreateUsingTempTokenResponse createUsingTempToken(
      PaymentSourceCreateUsingTempTokenParams params) throws ChargebeeException {
    Response response = createUsingTempTokenRaw(params);

    return PaymentSourceCreateUsingTempTokenResponse.fromJson(response.getBodyAsString(), response);
  }

  /** updateCard a paymentSource (executes immediately) - returns raw Response. */
  Response updateCardRaw(String custPaymentSourceId) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/update_card",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  /**
   * updateCard a paymentSource using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response updateCardRaw(String custPaymentSourceId, PaymentSourceUpdateCardParams params)
      throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/update_card",
            "cust-payment-source-id",
            custPaymentSourceId);
    return post(path, params.toFormData());
  }

  /**
   * updateCard a paymentSource using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response updateCardRaw(String custPaymentSourceId, String jsonPayload) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/update_card",
            "cust-payment-source-id",
            custPaymentSourceId);
    return postJson(path, jsonPayload);
  }

  public PaymentSourceUpdateCardResponse updateCard(
      String custPaymentSourceId, PaymentSourceUpdateCardParams params) throws ChargebeeException {
    Response response = updateCardRaw(custPaymentSourceId, params);
    return PaymentSourceUpdateCardResponse.fromJson(response.getBodyAsString(), response);
  }

  public PaymentSourceUpdateCardResponse updateCard(String custPaymentSourceId)
      throws ChargebeeException {
    Response response = updateCardRaw(custPaymentSourceId);
    return PaymentSourceUpdateCardResponse.fromJson(response.getBodyAsString(), response);
  }

  /** switchGatewayAccount a paymentSource (executes immediately) - returns raw Response. */
  Response switchGatewayAccountRaw(String custPaymentSourceId) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/switch_gateway_account",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  /**
   * switchGatewayAccount a paymentSource using immutable params (executes immediately) - returns
   * raw Response.
   */
  Response switchGatewayAccountRaw(
      String custPaymentSourceId, PaymentSourceSwitchGatewayAccountParams params)
      throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/switch_gateway_account",
            "cust-payment-source-id",
            custPaymentSourceId);
    return post(path, params.toFormData());
  }

  /**
   * switchGatewayAccount a paymentSource using raw JSON payload (executes immediately) - returns
   * raw Response.
   */
  Response switchGatewayAccountRaw(String custPaymentSourceId, String jsonPayload)
      throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/switch_gateway_account",
            "cust-payment-source-id",
            custPaymentSourceId);
    return postJson(path, jsonPayload);
  }

  public PaymentSourceSwitchGatewayAccountResponse switchGatewayAccount(
      String custPaymentSourceId, PaymentSourceSwitchGatewayAccountParams params)
      throws ChargebeeException {
    Response response = switchGatewayAccountRaw(custPaymentSourceId, params);
    return PaymentSourceSwitchGatewayAccountResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * createUsingToken a paymentSource using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response createUsingTokenRaw(PaymentSourceCreateUsingTokenParams params)
      throws ChargebeeException {

    return post("/payment_sources/create_using_token", params != null ? params.toFormData() : null);
  }

  /**
   * createUsingToken a paymentSource using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response createUsingTokenRaw(String jsonPayload) throws ChargebeeException {

    return postJson("/payment_sources/create_using_token", jsonPayload);
  }

  public PaymentSourceCreateUsingTokenResponse createUsingToken(
      PaymentSourceCreateUsingTokenParams params) throws ChargebeeException {
    Response response = createUsingTokenRaw(params);

    return PaymentSourceCreateUsingTokenResponse.fromJson(response.getBodyAsString(), response);
  }

  /** deleteLocal a paymentSource (executes immediately) - returns raw Response. */
  Response deleteLocalRaw(String custPaymentSourceId) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/delete_local",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  public PaymentSourceDeleteLocalResponse deleteLocal(String custPaymentSourceId)
      throws ChargebeeException {
    Response response = deleteLocalRaw(custPaymentSourceId);
    return PaymentSourceDeleteLocalResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * createBankAccount a paymentSource using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response createBankAccountRaw(PaymentSourceCreateBankAccountParams params)
      throws ChargebeeException {

    return post(
        "/payment_sources/create_bank_account", params != null ? params.toFormData() : null);
  }

  /**
   * createBankAccount a paymentSource using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response createBankAccountRaw(String jsonPayload) throws ChargebeeException {

    return postJson("/payment_sources/create_bank_account", jsonPayload);
  }

  public PaymentSourceCreateBankAccountResponse createBankAccount(
      PaymentSourceCreateBankAccountParams params) throws ChargebeeException {
    Response response = createBankAccountRaw(params);

    return PaymentSourceCreateBankAccountResponse.fromJson(response.getBodyAsString(), response);
  }

  /** updateBankAccount a paymentSource (executes immediately) - returns raw Response. */
  Response updateBankAccountRaw(String custPaymentSourceId) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/update_bank_account",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  /**
   * updateBankAccount a paymentSource using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response updateBankAccountRaw(
      String custPaymentSourceId, PaymentSourceUpdateBankAccountParams params)
      throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/update_bank_account",
            "cust-payment-source-id",
            custPaymentSourceId);
    return post(path, params.toFormData());
  }

  /**
   * updateBankAccount a paymentSource using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response updateBankAccountRaw(String custPaymentSourceId, String jsonPayload)
      throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/update_bank_account",
            "cust-payment-source-id",
            custPaymentSourceId);
    return postJson(path, jsonPayload);
  }

  public PaymentSourceUpdateBankAccountResponse updateBankAccount(
      String custPaymentSourceId, PaymentSourceUpdateBankAccountParams params)
      throws ChargebeeException {
    Response response = updateBankAccountRaw(custPaymentSourceId, params);
    return PaymentSourceUpdateBankAccountResponse.fromJson(response.getBodyAsString(), response);
  }

  public PaymentSourceUpdateBankAccountResponse updateBankAccount(String custPaymentSourceId)
      throws ChargebeeException {
    Response response = updateBankAccountRaw(custPaymentSourceId);
    return PaymentSourceUpdateBankAccountResponse.fromJson(response.getBodyAsString(), response);
  }
}
