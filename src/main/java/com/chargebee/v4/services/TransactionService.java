/*
 * This file is auto-generated by Chargebee.
 * For more information on how to make changes to this file, please see the README.
 * Reach out to dx@chargebee.com for any questions.
 * Copyright 2025 Chargebee Inc.
 */

package com.chargebee.v4.services;

import com.chargebee.v4.client.ChargebeeClient;
import com.chargebee.v4.client.request.RequestOptions;
import com.chargebee.v4.exceptions.ChargebeeException;
import com.chargebee.v4.transport.Response;

import com.chargebee.v4.models.transaction.params.TransactionListParams;

import com.chargebee.v4.models.transaction.params.TransactionReconcileParams;

import com.chargebee.v4.models.transaction.params.TransactionRefundParams;

import com.chargebee.v4.models.transaction.params.TransactionsForCustomerParams;

import com.chargebee.v4.models.transaction.params.TransactionRecordRefundParams;

import com.chargebee.v4.models.transaction.params.TransactionsForSubscriptionParams;

import com.chargebee.v4.models.transaction.params.TransactionCreateAuthorizationParams;

import com.chargebee.v4.models.transaction.params.TransactionPaymentsForInvoiceParams;

import com.chargebee.v4.models.transaction.params.DeleteOfflineTransactionParams;

import com.chargebee.v4.models.transaction.responses.TransactionListResponse;

import com.chargebee.v4.models.transaction.responses.TransactionReconcileResponse;

import com.chargebee.v4.models.transaction.responses.TransactionRetrieveResponse;

import com.chargebee.v4.models.transaction.responses.TransactionRefundResponse;

import com.chargebee.v4.models.transaction.responses.TransactionsForCustomerResponse;

import com.chargebee.v4.models.transaction.responses.TransactionRecordRefundResponse;

import com.chargebee.v4.models.transaction.responses.TransactionsForSubscriptionResponse;

import com.chargebee.v4.models.transaction.responses.VoidTransactionResponse;

import com.chargebee.v4.models.transaction.responses.SyncTransactionResponse;

import com.chargebee.v4.models.transaction.responses.TransactionCreateAuthorizationResponse;

import com.chargebee.v4.models.transaction.responses.TransactionPaymentsForInvoiceResponse;

import com.chargebee.v4.models.transaction.responses.DeleteOfflineTransactionResponse;

public final class TransactionService extends BaseService<TransactionService> {

  private final ServiceConfig config;

  public TransactionService(ChargebeeClient client) {
    super(client);
    this.config = ServiceConfig.defaultConfig();
  }

  private TransactionService(ChargebeeClient client, RequestOptions options) {
    super(client, options);
    this.config = ServiceConfig.defaultConfig();
  }

  private TransactionService(ChargebeeClient client, RequestOptions options, ServiceConfig config) {
    super(client, options);
    this.config = config;
  }

  @Override
  TransactionService with(RequestOptions newOptions) {
    return new TransactionService(client, newOptions, config);
  }

  /**
   * Apply per-request options for this service instance. Users can chain .withOptions or .options
   * to set headers and other options.
   */
  public TransactionService withOptions(RequestOptions options) {
    return with(options);
  }

  // === Operations ===

  /** list a transaction using immutable params (executes immediately) - returns raw Response. */
  Response listRaw(TransactionListParams params) throws ChargebeeException {

    return get("/transactions", params != null ? params.toQueryParams() : null);
  }

  /** list a transaction without params (executes immediately) - returns raw Response. */
  Response listRaw() throws ChargebeeException {

    return get("/transactions", null);
  }

  /** list a transaction using raw JSON payload (executes immediately) - returns raw Response. */
  Response listRaw(String jsonPayload) throws ChargebeeException {

    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public TransactionListResponse list(TransactionListParams params) throws ChargebeeException {
    Response response = listRaw(params);

    return TransactionListResponse.fromJson(response.getBodyAsString(), this, params, response);
  }

  public TransactionListResponse list() throws ChargebeeException {
    Response response = listRaw();

    return TransactionListResponse.fromJson(response.getBodyAsString(), this, null, response);
  }

  /** reconcile a transaction (executes immediately) - returns raw Response. */
  Response reconcileRaw(String transactionId) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/reconcile", "transaction-id", transactionId);

    return post(path, null);
  }

  /**
   * reconcile a transaction using immutable params (executes immediately) - returns raw Response.
   */
  Response reconcileRaw(String transactionId, TransactionReconcileParams params)
      throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/reconcile", "transaction-id", transactionId);
    return post(path, params.toFormData());
  }

  /**
   * reconcile a transaction using raw JSON payload (executes immediately) - returns raw Response.
   */
  Response reconcileRaw(String transactionId, String jsonPayload) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/reconcile", "transaction-id", transactionId);
    return postJson(path, jsonPayload);
  }

  public TransactionReconcileResponse reconcile(
      String transactionId, TransactionReconcileParams params) throws ChargebeeException {
    Response response = reconcileRaw(transactionId, params);
    return TransactionReconcileResponse.fromJson(response.getBodyAsString(), response);
  }

  public TransactionReconcileResponse reconcile(String transactionId) throws ChargebeeException {
    Response response = reconcileRaw(transactionId);
    return TransactionReconcileResponse.fromJson(response.getBodyAsString(), response);
  }

  /** retrieve a transaction (executes immediately) - returns raw Response. */
  Response retrieveRaw(String transactionId) throws ChargebeeException {
    String path =
        buildPathWithParams("/transactions/{transaction-id}", "transaction-id", transactionId);

    return get(path, null);
  }

  public TransactionRetrieveResponse retrieve(String transactionId) throws ChargebeeException {
    Response response = retrieveRaw(transactionId);
    return TransactionRetrieveResponse.fromJson(response.getBodyAsString(), response);
  }

  /** refund a transaction (executes immediately) - returns raw Response. */
  Response refundRaw(String transactionId) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/refund", "transaction-id", transactionId);

    return post(path, null);
  }

  /** refund a transaction using immutable params (executes immediately) - returns raw Response. */
  Response refundRaw(String transactionId, TransactionRefundParams params)
      throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/refund", "transaction-id", transactionId);
    return post(path, params.toFormData());
  }

  /** refund a transaction using raw JSON payload (executes immediately) - returns raw Response. */
  Response refundRaw(String transactionId, String jsonPayload) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/refund", "transaction-id", transactionId);
    return postJson(path, jsonPayload);
  }

  public TransactionRefundResponse refund(String transactionId, TransactionRefundParams params)
      throws ChargebeeException {
    Response response = refundRaw(transactionId, params);
    return TransactionRefundResponse.fromJson(response.getBodyAsString(), response);
  }

  public TransactionRefundResponse refund(String transactionId) throws ChargebeeException {
    Response response = refundRaw(transactionId);
    return TransactionRefundResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * transactionsForCustomer a transaction using immutable params (executes immediately) - returns
   * raw Response.
   */
  Response transactionsForCustomerRaw(String customerId, TransactionsForCustomerParams params)
      throws ChargebeeException {
    String path =
        buildPathWithParams("/customers/{customer-id}/transactions", "customer-id", customerId);
    return get(path, params != null ? params.toQueryParams() : null);
  }

  /**
   * transactionsForCustomer a transaction without params (executes immediately) - returns raw
   * Response.
   */
  Response transactionsForCustomerRaw(String customerId) throws ChargebeeException {
    String path =
        buildPathWithParams("/customers/{customer-id}/transactions", "customer-id", customerId);
    return get(path, null);
  }

  /**
   * transactionsForCustomer a transaction using raw JSON payload (executes immediately) - returns
   * raw Response.
   */
  Response transactionsForCustomerRaw(String customerId, String jsonPayload)
      throws ChargebeeException {
    String path =
        buildPathWithParams("/customers/{customer-id}/transactions", "customer-id", customerId);
    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public TransactionsForCustomerResponse transactionsForCustomer(
      String customerId, TransactionsForCustomerParams params) throws ChargebeeException {
    Response response = transactionsForCustomerRaw(customerId, params);
    return TransactionsForCustomerResponse.fromJson(
        response.getBodyAsString(), this, params, customerId, response);
  }

  public TransactionsForCustomerResponse transactionsForCustomer(String customerId)
      throws ChargebeeException {
    Response response = transactionsForCustomerRaw(customerId);
    return TransactionsForCustomerResponse.fromJson(
        response.getBodyAsString(), this, null, customerId, response);
  }

  /** recordRefund a transaction (executes immediately) - returns raw Response. */
  Response recordRefundRaw(String transactionId) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/record_refund", "transaction-id", transactionId);

    return post(path, null);
  }

  /**
   * recordRefund a transaction using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response recordRefundRaw(String transactionId, TransactionRecordRefundParams params)
      throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/record_refund", "transaction-id", transactionId);
    return post(path, params.toFormData());
  }

  /**
   * recordRefund a transaction using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response recordRefundRaw(String transactionId, String jsonPayload) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/record_refund", "transaction-id", transactionId);
    return postJson(path, jsonPayload);
  }

  public TransactionRecordRefundResponse recordRefund(
      String transactionId, TransactionRecordRefundParams params) throws ChargebeeException {
    Response response = recordRefundRaw(transactionId, params);
    return TransactionRecordRefundResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * transactionsForSubscription a transaction using immutable params (executes immediately) -
   * returns raw Response.
   */
  Response transactionsForSubscriptionRaw(
      String subscriptionId, TransactionsForSubscriptionParams params) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/subscriptions/{subscription-id}/transactions", "subscription-id", subscriptionId);
    return get(path, params != null ? params.toQueryParams() : null);
  }

  /**
   * transactionsForSubscription a transaction without params (executes immediately) - returns raw
   * Response.
   */
  Response transactionsForSubscriptionRaw(String subscriptionId) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/subscriptions/{subscription-id}/transactions", "subscription-id", subscriptionId);
    return get(path, null);
  }

  /**
   * transactionsForSubscription a transaction using raw JSON payload (executes immediately) -
   * returns raw Response.
   */
  Response transactionsForSubscriptionRaw(String subscriptionId, String jsonPayload)
      throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/subscriptions/{subscription-id}/transactions", "subscription-id", subscriptionId);
    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public TransactionsForSubscriptionResponse transactionsForSubscription(
      String subscriptionId, TransactionsForSubscriptionParams params) throws ChargebeeException {
    Response response = transactionsForSubscriptionRaw(subscriptionId, params);
    return TransactionsForSubscriptionResponse.fromJson(
        response.getBodyAsString(), this, params, subscriptionId, response);
  }

  public TransactionsForSubscriptionResponse transactionsForSubscription(String subscriptionId)
      throws ChargebeeException {
    Response response = transactionsForSubscriptionRaw(subscriptionId);
    return TransactionsForSubscriptionResponse.fromJson(
        response.getBodyAsString(), this, null, subscriptionId, response);
  }

  /** voidTransaction a transaction (executes immediately) - returns raw Response. */
  Response voidTransactionRaw(String transactionId) throws ChargebeeException {
    String path =
        buildPathWithParams("/transactions/{transaction-id}/void", "transaction-id", transactionId);

    return post(path, null);
  }

  public VoidTransactionResponse voidTransaction(String transactionId) throws ChargebeeException {
    Response response = voidTransactionRaw(transactionId);
    return VoidTransactionResponse.fromJson(response.getBodyAsString(), response);
  }

  /** syncTransaction a transaction (executes immediately) - returns raw Response. */
  Response syncTransactionRaw(String transactionId) throws ChargebeeException {
    String path =
        buildPathWithParams("/transactions/{transaction-id}/sync", "transaction-id", transactionId);

    return post(path, null);
  }

  public SyncTransactionResponse syncTransaction(String transactionId) throws ChargebeeException {
    Response response = syncTransactionRaw(transactionId);
    return SyncTransactionResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * createAuthorization a transaction using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response createAuthorizationRaw(TransactionCreateAuthorizationParams params)
      throws ChargebeeException {

    return post("/transactions/create_authorization", params != null ? params.toFormData() : null);
  }

  /**
   * createAuthorization a transaction using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response createAuthorizationRaw(String jsonPayload) throws ChargebeeException {

    return postJson("/transactions/create_authorization", jsonPayload);
  }

  public TransactionCreateAuthorizationResponse createAuthorization(
      TransactionCreateAuthorizationParams params) throws ChargebeeException {
    Response response = createAuthorizationRaw(params);

    return TransactionCreateAuthorizationResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * paymentsForInvoice a transaction using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response paymentsForInvoiceRaw(String invoiceId, TransactionPaymentsForInvoiceParams params)
      throws ChargebeeException {
    String path = buildPathWithParams("/invoices/{invoice-id}/payments", "invoice-id", invoiceId);
    return get(path, params != null ? params.toQueryParams() : null);
  }

  /**
   * paymentsForInvoice a transaction without params (executes immediately) - returns raw Response.
   */
  Response paymentsForInvoiceRaw(String invoiceId) throws ChargebeeException {
    String path = buildPathWithParams("/invoices/{invoice-id}/payments", "invoice-id", invoiceId);
    return get(path, null);
  }

  /**
   * paymentsForInvoice a transaction using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response paymentsForInvoiceRaw(String invoiceId, String jsonPayload) throws ChargebeeException {
    String path = buildPathWithParams("/invoices/{invoice-id}/payments", "invoice-id", invoiceId);
    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public TransactionPaymentsForInvoiceResponse paymentsForInvoice(
      String invoiceId, TransactionPaymentsForInvoiceParams params) throws ChargebeeException {
    Response response = paymentsForInvoiceRaw(invoiceId, params);
    return TransactionPaymentsForInvoiceResponse.fromJson(
        response.getBodyAsString(), this, params, invoiceId, response);
  }

  public TransactionPaymentsForInvoiceResponse paymentsForInvoice(String invoiceId)
      throws ChargebeeException {
    Response response = paymentsForInvoiceRaw(invoiceId);
    return TransactionPaymentsForInvoiceResponse.fromJson(
        response.getBodyAsString(), this, null, invoiceId, response);
  }

  /** deleteOfflineTransaction a transaction (executes immediately) - returns raw Response. */
  Response deleteOfflineTransactionRaw(String transactionId) throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/delete_offline_transaction",
            "transaction-id",
            transactionId);

    return post(path, null);
  }

  /**
   * deleteOfflineTransaction a transaction using immutable params (executes immediately) - returns
   * raw Response.
   */
  Response deleteOfflineTransactionRaw(String transactionId, DeleteOfflineTransactionParams params)
      throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/delete_offline_transaction",
            "transaction-id",
            transactionId);
    return post(path, params.toFormData());
  }

  /**
   * deleteOfflineTransaction a transaction using raw JSON payload (executes immediately) - returns
   * raw Response.
   */
  Response deleteOfflineTransactionRaw(String transactionId, String jsonPayload)
      throws ChargebeeException {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/delete_offline_transaction",
            "transaction-id",
            transactionId);
    return postJson(path, jsonPayload);
  }

  public DeleteOfflineTransactionResponse deleteOfflineTransaction(
      String transactionId, DeleteOfflineTransactionParams params) throws ChargebeeException {
    Response response = deleteOfflineTransactionRaw(transactionId, params);
    return DeleteOfflineTransactionResponse.fromJson(response.getBodyAsString(), response);
  }

  public DeleteOfflineTransactionResponse deleteOfflineTransaction(String transactionId)
      throws ChargebeeException {
    Response response = deleteOfflineTransactionRaw(transactionId);
    return DeleteOfflineTransactionResponse.fromJson(response.getBodyAsString(), response);
  }
}
