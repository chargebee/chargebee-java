/*
 * This file is auto-generated by Chargebee.
 * For more information on how to make changes to this file, please see the README.
 * Reach out to dx@chargebee.com for any questions.
 * Copyright 2025 Chargebee Inc.
 */

package com.chargebee.v4.services;

import com.chargebee.v4.client.ChargebeeClient;
import com.chargebee.v4.client.request.RequestOptions;
import com.chargebee.v4.transport.Response;

import com.chargebee.v4.models.transaction.params.TransactionListParams;

import com.chargebee.v4.models.transaction.params.ReconcileForTransactionParams;

import com.chargebee.v4.models.transaction.params.RefundForTransactionParams;

import com.chargebee.v4.models.transaction.params.TransactionsForCustomerParams;

import com.chargebee.v4.models.transaction.params.RecordRefundForTransactionParams;

import com.chargebee.v4.models.transaction.params.TransactionsForSubscriptionParams;

import com.chargebee.v4.models.transaction.params.TransactionCreateAuthorizationParams;

import com.chargebee.v4.models.transaction.params.TransactionPaymentsForInvoiceParams;

import com.chargebee.v4.models.transaction.params.DeleteOfflineTransactionForTransactionParams;

import com.chargebee.v4.models.transaction.responses.TransactionListResponse;

import com.chargebee.v4.models.transaction.responses.ReconcileForTransactionResponse;

import com.chargebee.v4.models.transaction.responses.TransactionRetrieveResponse;

import com.chargebee.v4.models.transaction.responses.RefundForTransactionResponse;

import com.chargebee.v4.models.transaction.responses.TransactionsForCustomerResponse;

import com.chargebee.v4.models.transaction.responses.RecordRefundForTransactionResponse;

import com.chargebee.v4.models.transaction.responses.TransactionsForSubscriptionResponse;

import com.chargebee.v4.models.transaction.responses.VoidTransactionResponse;

import com.chargebee.v4.models.transaction.responses.SyncForTransactionResponse;

import com.chargebee.v4.models.transaction.responses.TransactionCreateAuthorizationResponse;

import com.chargebee.v4.models.transaction.responses.TransactionPaymentsForInvoiceResponse;

import com.chargebee.v4.models.transaction.responses.DeleteOfflineTransactionForTransactionResponse;

public final class TransactionService extends BaseService<TransactionService> {

  private final ServiceConfig config;

  public TransactionService(ChargebeeClient client) {
    super(client);
    this.config = ServiceConfig.defaultConfig();
  }

  private TransactionService(ChargebeeClient client, RequestOptions options) {
    super(client, options);
    this.config = ServiceConfig.defaultConfig();
  }

  private TransactionService(ChargebeeClient client, RequestOptions options, ServiceConfig config) {
    super(client, options);
    this.config = config;
  }

  @Override
  TransactionService with(RequestOptions newOptions) {
    return new TransactionService(client, newOptions, config);
  }

  /**
   * Apply per-request options for this service instance. Users can chain .withOptions or .options
   * to set headers and other options.
   */
  public TransactionService withOptions(RequestOptions options) {
    return with(options);
  }

  // === Operations ===

  /** list a transaction using immutable params (executes immediately) - returns raw Response. */
  Response listRaw(TransactionListParams params) throws Exception {

    return get("/transactions", params != null ? params.toQueryParams() : null);
  }

  /** list a transaction without params (executes immediately) - returns raw Response. */
  Response listRaw() throws Exception {

    return get("/transactions", null);
  }

  /** list a transaction using raw JSON payload (executes immediately) - returns raw Response. */
  Response listRaw(String jsonPayload) throws Exception {

    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public TransactionListResponse list(TransactionListParams params) throws Exception {
    Response response = listRaw(params);

    return TransactionListResponse.fromJson(response.getBodyAsString(), this, params, response);
  }

  public TransactionListResponse list() throws Exception {
    Response response = listRaw();
    return TransactionListResponse.fromJson(response.getBodyAsString(), this, null, response);
  }

  /** reconcileForTransaction a transaction (executes immediately) - returns raw Response. */
  Response reconcileForTransactionRaw(String transactionId) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/reconcile", "transaction-id", transactionId);

    return post(path, null);
  }

  /**
   * reconcileForTransaction a transaction using immutable params (executes immediately) - returns
   * raw Response.
   */
  Response reconcileForTransactionRaw(String transactionId, ReconcileForTransactionParams params)
      throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/reconcile", "transaction-id", transactionId);
    return post(path, params.toFormData());
  }

  /**
   * reconcileForTransaction a transaction using raw JSON payload (executes immediately) - returns
   * raw Response.
   */
  Response reconcileForTransactionRaw(String transactionId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/reconcile", "transaction-id", transactionId);
    return postJson(path, jsonPayload);
  }

  public ReconcileForTransactionResponse reconcileForTransaction(
      String transactionId, ReconcileForTransactionParams params) throws Exception {
    Response response = reconcileForTransactionRaw(transactionId, params);
    return ReconcileForTransactionResponse.fromJson(response.getBodyAsString(), response);
  }

  /** retrieve a transaction (executes immediately) - returns raw Response. */
  Response retrieveRaw(String transactionId) throws Exception {
    String path =
        buildPathWithParams("/transactions/{transaction-id}", "transaction-id", transactionId);

    return get(path, null);
  }

  public TransactionRetrieveResponse retrieve(String transactionId) throws Exception {
    Response response = retrieveRaw(transactionId);
    return TransactionRetrieveResponse.fromJson(response.getBodyAsString(), response);
  }

  /** refundForTransaction a transaction (executes immediately) - returns raw Response. */
  Response refundForTransactionRaw(String transactionId) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/refund", "transaction-id", transactionId);

    return post(path, null);
  }

  /**
   * refundForTransaction a transaction using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response refundForTransactionRaw(String transactionId, RefundForTransactionParams params)
      throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/refund", "transaction-id", transactionId);
    return post(path, params.toFormData());
  }

  /**
   * refundForTransaction a transaction using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response refundForTransactionRaw(String transactionId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/refund", "transaction-id", transactionId);
    return postJson(path, jsonPayload);
  }

  public RefundForTransactionResponse refundForTransaction(
      String transactionId, RefundForTransactionParams params) throws Exception {
    Response response = refundForTransactionRaw(transactionId, params);
    return RefundForTransactionResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * transactionsForCustomer a transaction using immutable params (executes immediately) - returns
   * raw Response.
   */
  Response transactionsForCustomerRaw(String customerId, TransactionsForCustomerParams params)
      throws Exception {
    String path =
        buildPathWithParams("/customers/{customer-id}/transactions", "customer-id", customerId);
    return get(path, params != null ? params.toQueryParams() : null);
  }

  /**
   * transactionsForCustomer a transaction without params (executes immediately) - returns raw
   * Response.
   */
  Response transactionsForCustomerRaw(String customerId) throws Exception {
    String path =
        buildPathWithParams("/customers/{customer-id}/transactions", "customer-id", customerId);
    return get(path, null);
  }

  /**
   * transactionsForCustomer a transaction using raw JSON payload (executes immediately) - returns
   * raw Response.
   */
  Response transactionsForCustomerRaw(String customerId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/customers/{customer-id}/transactions", "customer-id", customerId);
    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public TransactionsForCustomerResponse transactionsForCustomer(
      String customerId, TransactionsForCustomerParams params) throws Exception {
    Response response = transactionsForCustomerRaw(customerId, params);
    return TransactionsForCustomerResponse.fromJson(
        response.getBodyAsString(), this, params, customerId, response);
  }

  public TransactionsForCustomerResponse transactionsForCustomer(String customerId)
      throws Exception {
    Response response = transactionsForCustomerRaw(customerId);
    return TransactionsForCustomerResponse.fromJson(
        response.getBodyAsString(), this, null, customerId, response);
  }

  /** recordRefundForTransaction a transaction (executes immediately) - returns raw Response. */
  Response recordRefundForTransactionRaw(String transactionId) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/record_refund", "transaction-id", transactionId);

    return post(path, null);
  }

  /**
   * recordRefundForTransaction a transaction using immutable params (executes immediately) -
   * returns raw Response.
   */
  Response recordRefundForTransactionRaw(
      String transactionId, RecordRefundForTransactionParams params) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/record_refund", "transaction-id", transactionId);
    return post(path, params.toFormData());
  }

  /**
   * recordRefundForTransaction a transaction using raw JSON payload (executes immediately) -
   * returns raw Response.
   */
  Response recordRefundForTransactionRaw(String transactionId, String jsonPayload)
      throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/record_refund", "transaction-id", transactionId);
    return postJson(path, jsonPayload);
  }

  public RecordRefundForTransactionResponse recordRefundForTransaction(
      String transactionId, RecordRefundForTransactionParams params) throws Exception {
    Response response = recordRefundForTransactionRaw(transactionId, params);
    return RecordRefundForTransactionResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * transactionsForSubscription a transaction using immutable params (executes immediately) -
   * returns raw Response.
   */
  Response transactionsForSubscriptionRaw(
      String subscriptionId, TransactionsForSubscriptionParams params) throws Exception {
    String path =
        buildPathWithParams(
            "/subscriptions/{subscription-id}/transactions", "subscription-id", subscriptionId);
    return get(path, params != null ? params.toQueryParams() : null);
  }

  /**
   * transactionsForSubscription a transaction without params (executes immediately) - returns raw
   * Response.
   */
  Response transactionsForSubscriptionRaw(String subscriptionId) throws Exception {
    String path =
        buildPathWithParams(
            "/subscriptions/{subscription-id}/transactions", "subscription-id", subscriptionId);
    return get(path, null);
  }

  /**
   * transactionsForSubscription a transaction using raw JSON payload (executes immediately) -
   * returns raw Response.
   */
  Response transactionsForSubscriptionRaw(String subscriptionId, String jsonPayload)
      throws Exception {
    String path =
        buildPathWithParams(
            "/subscriptions/{subscription-id}/transactions", "subscription-id", subscriptionId);
    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public TransactionsForSubscriptionResponse transactionsForSubscription(
      String subscriptionId, TransactionsForSubscriptionParams params) throws Exception {
    Response response = transactionsForSubscriptionRaw(subscriptionId, params);
    return TransactionsForSubscriptionResponse.fromJson(
        response.getBodyAsString(), this, params, subscriptionId, response);
  }

  public TransactionsForSubscriptionResponse transactionsForSubscription(String subscriptionId)
      throws Exception {
    Response response = transactionsForSubscriptionRaw(subscriptionId);
    return TransactionsForSubscriptionResponse.fromJson(
        response.getBodyAsString(), this, null, subscriptionId, response);
  }

  /** voidTransaction a transaction (executes immediately) - returns raw Response. */
  Response voidTransactionRaw(String transactionId) throws Exception {
    String path =
        buildPathWithParams("/transactions/{transaction-id}/void", "transaction-id", transactionId);

    return post(path, null);
  }

  public VoidTransactionResponse voidTransaction(String transactionId) throws Exception {
    Response response = voidTransactionRaw(transactionId);
    return VoidTransactionResponse.fromJson(response.getBodyAsString(), response);
  }

  /** syncForTransaction a transaction (executes immediately) - returns raw Response. */
  Response syncForTransactionRaw(String transactionId) throws Exception {
    String path =
        buildPathWithParams("/transactions/{transaction-id}/sync", "transaction-id", transactionId);

    return post(path, null);
  }

  public SyncForTransactionResponse syncForTransaction(String transactionId) throws Exception {
    Response response = syncForTransactionRaw(transactionId);
    return SyncForTransactionResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * createAuthorization a transaction using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response createAuthorizationRaw(TransactionCreateAuthorizationParams params) throws Exception {

    return post("/transactions/create_authorization", params != null ? params.toFormData() : null);
  }

  /**
   * createAuthorization a transaction using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response createAuthorizationRaw(String jsonPayload) throws Exception {

    return postJson("/transactions/create_authorization", jsonPayload);
  }

  public TransactionCreateAuthorizationResponse createAuthorization(
      TransactionCreateAuthorizationParams params) throws Exception {
    Response response = createAuthorizationRaw(params);

    return TransactionCreateAuthorizationResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * paymentsForInvoice a transaction using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response paymentsForInvoiceRaw(String invoiceId, TransactionPaymentsForInvoiceParams params)
      throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/payments", "invoice-id", invoiceId);
    return get(path, params != null ? params.toQueryParams() : null);
  }

  /**
   * paymentsForInvoice a transaction without params (executes immediately) - returns raw Response.
   */
  Response paymentsForInvoiceRaw(String invoiceId) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/payments", "invoice-id", invoiceId);
    return get(path, null);
  }

  /**
   * paymentsForInvoice a transaction using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response paymentsForInvoiceRaw(String invoiceId, String jsonPayload) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/payments", "invoice-id", invoiceId);
    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public TransactionPaymentsForInvoiceResponse paymentsForInvoice(
      String invoiceId, TransactionPaymentsForInvoiceParams params) throws Exception {
    Response response = paymentsForInvoiceRaw(invoiceId, params);
    return TransactionPaymentsForInvoiceResponse.fromJson(
        response.getBodyAsString(), this, params, invoiceId, response);
  }

  public TransactionPaymentsForInvoiceResponse paymentsForInvoice(String invoiceId)
      throws Exception {
    Response response = paymentsForInvoiceRaw(invoiceId);
    return TransactionPaymentsForInvoiceResponse.fromJson(
        response.getBodyAsString(), this, null, invoiceId, response);
  }

  /**
   * deleteOfflineTransactionForTransaction a transaction (executes immediately) - returns raw
   * Response.
   */
  Response deleteOfflineTransactionForTransactionRaw(String transactionId) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/delete_offline_transaction",
            "transaction-id",
            transactionId);

    return post(path, null);
  }

  /**
   * deleteOfflineTransactionForTransaction a transaction using immutable params (executes
   * immediately) - returns raw Response.
   */
  Response deleteOfflineTransactionForTransactionRaw(
      String transactionId, DeleteOfflineTransactionForTransactionParams params) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/delete_offline_transaction",
            "transaction-id",
            transactionId);
    return post(path, params.toFormData());
  }

  /**
   * deleteOfflineTransactionForTransaction a transaction using raw JSON payload (executes
   * immediately) - returns raw Response.
   */
  Response deleteOfflineTransactionForTransactionRaw(String transactionId, String jsonPayload)
      throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/delete_offline_transaction",
            "transaction-id",
            transactionId);
    return postJson(path, jsonPayload);
  }

  public DeleteOfflineTransactionForTransactionResponse deleteOfflineTransactionForTransaction(
      String transactionId, DeleteOfflineTransactionForTransactionParams params) throws Exception {
    Response response = deleteOfflineTransactionForTransactionRaw(transactionId, params);
    return DeleteOfflineTransactionForTransactionResponse.fromJson(
        response.getBodyAsString(), response);
  }
}
