/*
 * This file is auto-generated by Chargebee.
 * For more information on how to make changes to this file, please see the README.
 * Reach out to dx@chargebee.com for any questions.
 * Copyright 2025 Chargebee Inc.
 */

package com.chargebee.v4.core.services;

import com.chargebee.v4.client.ChargebeeClient;
import com.chargebee.v4.client.request.RequestOptions;
import com.chargebee.v4.transport.Response;

import com.chargebee.v4.core.models.transaction.params.TransactionListParams;

import com.chargebee.v4.core.models.transaction.params.TransactionReconcileParams;

import com.chargebee.v4.core.models.transaction.params.TransactionRefundParams;

import com.chargebee.v4.core.models.transaction.params.TransactionTransactionsForCustomerParams;

import com.chargebee.v4.core.models.transaction.params.TransactionRecordRefundParams;

import com.chargebee.v4.core.models.transaction.params.TransactionTransactionsForSubscriptionParams;

import com.chargebee.v4.core.models.transaction.params.TransactionCreateAuthorizationParams;

import com.chargebee.v4.core.models.transaction.params.TransactionPaymentsForInvoiceParams;

import com.chargebee.v4.core.models.transaction.params.TransactionDeleteOfflineTransactionParams;

import com.chargebee.v4.core.responses.transaction.TransactionListResponse;

import com.chargebee.v4.core.responses.transaction.TransactionReconcileResponse;

import com.chargebee.v4.core.responses.transaction.TransactionRetrieveResponse;

import com.chargebee.v4.core.responses.transaction.TransactionRefundResponse;

import com.chargebee.v4.core.responses.transaction.TransactionTransactionsForCustomerResponse;

import com.chargebee.v4.core.responses.transaction.TransactionRecordRefundResponse;

import com.chargebee.v4.core.responses.transaction.TransactionTransactionsForSubscriptionResponse;

import com.chargebee.v4.core.responses.transaction.TransactionVoidTransactionResponse;

import com.chargebee.v4.core.responses.transaction.TransactionSyncTransactionResponse;

import com.chargebee.v4.core.responses.transaction.TransactionCreateAuthorizationResponse;

import com.chargebee.v4.core.responses.transaction.TransactionPaymentsForInvoiceResponse;

import com.chargebee.v4.core.responses.transaction.TransactionDeleteOfflineTransactionResponse;

public final class TransactionService extends BaseService<TransactionService> {

  private final ServiceConfig config;

  public TransactionService(ChargebeeClient client) {
    super(client);
    this.config = ServiceConfig.defaultConfig();
  }

  private TransactionService(ChargebeeClient client, RequestOptions options) {
    super(client, options);
    this.config = ServiceConfig.defaultConfig();
  }

  private TransactionService(ChargebeeClient client, RequestOptions options, ServiceConfig config) {
    super(client, options);
    this.config = config;
  }

  @Override
  TransactionService with(RequestOptions newOptions) {
    return new TransactionService(client, newOptions, config);
  }

  /**
   * Apply per-request options for this service instance. Users can chain .withOptions or .options
   * to set headers and other options.
   */
  public TransactionService withOptions(RequestOptions options) {
    return with(options);
  }

  // === Operations ===

  /** list a transaction using immutable params (executes immediately) - returns raw Response. */
  Response listRaw(TransactionListParams params) throws Exception {

    return get("/transactions", params != null ? params.toQueryParams() : null);
  }

  /** list a transaction without params (executes immediately) - returns raw Response. */
  Response listRaw() throws Exception {

    return get("/transactions", null);
  }

  /** list a transaction using raw JSON payload (executes immediately) - returns raw Response. */
  Response listRaw(String jsonPayload) throws Exception {

    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public TransactionListResponse list(TransactionListParams params) throws Exception {
    Response response = listRaw(params);

    return TransactionListResponse.fromJson(response.getBodyAsString(), this, params, response);
  }

  public TransactionListResponse list() throws Exception {
    Response response = listRaw();
    return TransactionListResponse.fromJson(response.getBodyAsString(), this, null, response);
  }

  /** reconcile a transaction (executes immediately) - returns raw Response. */
  Response reconcileRaw(String transactionId) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/reconcile", "transaction-id", transactionId);

    return post(path, null);
  }

  /**
   * reconcile a transaction using immutable params (executes immediately) - returns raw Response.
   */
  Response reconcileRaw(String transactionId, TransactionReconcileParams params) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/reconcile", "transaction-id", transactionId);
    return post(path, params.toFormData());
  }

  /**
   * reconcile a transaction using raw JSON payload (executes immediately) - returns raw Response.
   */
  Response reconcileRaw(String transactionId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/reconcile", "transaction-id", transactionId);
    return postJson(path, jsonPayload);
  }

  public TransactionReconcileResponse reconcile(
      String transactionId, TransactionReconcileParams params) throws Exception {
    Response response = reconcileRaw(transactionId, params);
    return TransactionReconcileResponse.fromJson(response.getBodyAsString(), response);
  }

  /** retrieve a transaction (executes immediately) - returns raw Response. */
  Response retrieveRaw(String transactionId) throws Exception {
    String path =
        buildPathWithParams("/transactions/{transaction-id}", "transaction-id", transactionId);

    return get(path, null);
  }

  public TransactionRetrieveResponse retrieve(String transactionId) throws Exception {
    Response response = retrieveRaw(transactionId);
    return TransactionRetrieveResponse.fromJson(response.getBodyAsString(), response);
  }

  /** refund a transaction (executes immediately) - returns raw Response. */
  Response refundRaw(String transactionId) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/refund", "transaction-id", transactionId);

    return post(path, null);
  }

  /** refund a transaction using immutable params (executes immediately) - returns raw Response. */
  Response refundRaw(String transactionId, TransactionRefundParams params) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/refund", "transaction-id", transactionId);
    return post(path, params.toFormData());
  }

  /** refund a transaction using raw JSON payload (executes immediately) - returns raw Response. */
  Response refundRaw(String transactionId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/refund", "transaction-id", transactionId);
    return postJson(path, jsonPayload);
  }

  public TransactionRefundResponse refund(String transactionId, TransactionRefundParams params)
      throws Exception {
    Response response = refundRaw(transactionId, params);
    return TransactionRefundResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * transactionsForCustomer a transaction using immutable params (executes immediately) - returns
   * raw Response.
   */
  Response transactionsForCustomerRaw(
      String customerId, TransactionTransactionsForCustomerParams params) throws Exception {
    String path =
        buildPathWithParams("/customers/{customer-id}/transactions", "customer-id", customerId);
    return get(path, params != null ? params.toQueryParams() : null);
  }

  /**
   * transactionsForCustomer a transaction without params (executes immediately) - returns raw
   * Response.
   */
  Response transactionsForCustomerRaw(String customerId) throws Exception {
    String path =
        buildPathWithParams("/customers/{customer-id}/transactions", "customer-id", customerId);
    return get(path, null);
  }

  /**
   * transactionsForCustomer a transaction using raw JSON payload (executes immediately) - returns
   * raw Response.
   */
  Response transactionsForCustomerRaw(String customerId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/customers/{customer-id}/transactions", "customer-id", customerId);
    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public TransactionTransactionsForCustomerResponse transactionsForCustomer(
      String customerId, TransactionTransactionsForCustomerParams params) throws Exception {
    Response response = transactionsForCustomerRaw(customerId, params);
    return TransactionTransactionsForCustomerResponse.fromJson(
        response.getBodyAsString(), this, params, customerId, response);
  }

  public TransactionTransactionsForCustomerResponse transactionsForCustomer(String customerId)
      throws Exception {
    Response response = transactionsForCustomerRaw(customerId);
    return TransactionTransactionsForCustomerResponse.fromJson(
        response.getBodyAsString(), this, null, customerId, response);
  }

  /** recordRefund a transaction (executes immediately) - returns raw Response. */
  Response recordRefundRaw(String transactionId) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/record_refund", "transaction-id", transactionId);

    return post(path, null);
  }

  /**
   * recordRefund a transaction using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response recordRefundRaw(String transactionId, TransactionRecordRefundParams params)
      throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/record_refund", "transaction-id", transactionId);
    return post(path, params.toFormData());
  }

  /**
   * recordRefund a transaction using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response recordRefundRaw(String transactionId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/record_refund", "transaction-id", transactionId);
    return postJson(path, jsonPayload);
  }

  public TransactionRecordRefundResponse recordRefund(
      String transactionId, TransactionRecordRefundParams params) throws Exception {
    Response response = recordRefundRaw(transactionId, params);
    return TransactionRecordRefundResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * transactionsForSubscription a transaction using immutable params (executes immediately) -
   * returns raw Response.
   */
  Response transactionsForSubscriptionRaw(
      String subscriptionId, TransactionTransactionsForSubscriptionParams params) throws Exception {
    String path =
        buildPathWithParams(
            "/subscriptions/{subscription-id}/transactions", "subscription-id", subscriptionId);
    return get(path, params != null ? params.toQueryParams() : null);
  }

  /**
   * transactionsForSubscription a transaction without params (executes immediately) - returns raw
   * Response.
   */
  Response transactionsForSubscriptionRaw(String subscriptionId) throws Exception {
    String path =
        buildPathWithParams(
            "/subscriptions/{subscription-id}/transactions", "subscription-id", subscriptionId);
    return get(path, null);
  }

  /**
   * transactionsForSubscription a transaction using raw JSON payload (executes immediately) -
   * returns raw Response.
   */
  Response transactionsForSubscriptionRaw(String subscriptionId, String jsonPayload)
      throws Exception {
    String path =
        buildPathWithParams(
            "/subscriptions/{subscription-id}/transactions", "subscription-id", subscriptionId);
    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public TransactionTransactionsForSubscriptionResponse transactionsForSubscription(
      String subscriptionId, TransactionTransactionsForSubscriptionParams params) throws Exception {
    Response response = transactionsForSubscriptionRaw(subscriptionId, params);
    return TransactionTransactionsForSubscriptionResponse.fromJson(
        response.getBodyAsString(), this, params, subscriptionId, response);
  }

  public TransactionTransactionsForSubscriptionResponse transactionsForSubscription(
      String subscriptionId) throws Exception {
    Response response = transactionsForSubscriptionRaw(subscriptionId);
    return TransactionTransactionsForSubscriptionResponse.fromJson(
        response.getBodyAsString(), this, null, subscriptionId, response);
  }

  /** voidTransaction a transaction (executes immediately) - returns raw Response. */
  Response voidTransactionRaw(String transactionId) throws Exception {
    String path =
        buildPathWithParams("/transactions/{transaction-id}/void", "transaction-id", transactionId);

    return post(path, null);
  }

  public TransactionVoidTransactionResponse voidTransaction(String transactionId) throws Exception {
    Response response = voidTransactionRaw(transactionId);
    return TransactionVoidTransactionResponse.fromJson(response.getBodyAsString(), response);
  }

  /** syncTransaction a transaction (executes immediately) - returns raw Response. */
  Response syncTransactionRaw(String transactionId) throws Exception {
    String path =
        buildPathWithParams("/transactions/{transaction-id}/sync", "transaction-id", transactionId);

    return post(path, null);
  }

  public TransactionSyncTransactionResponse syncTransaction(String transactionId) throws Exception {
    Response response = syncTransactionRaw(transactionId);
    return TransactionSyncTransactionResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * createAuthorization a transaction using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response createAuthorizationRaw(TransactionCreateAuthorizationParams params) throws Exception {

    return post("/transactions/create_authorization", params != null ? params.toFormData() : null);
  }

  /**
   * createAuthorization a transaction using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response createAuthorizationRaw(String jsonPayload) throws Exception {

    return postJson("/transactions/create_authorization", jsonPayload);
  }

  public TransactionCreateAuthorizationResponse createAuthorization(
      TransactionCreateAuthorizationParams params) throws Exception {
    Response response = createAuthorizationRaw(params);

    return TransactionCreateAuthorizationResponse.fromJson(response.getBodyAsString(), response);
  }

  /**
   * paymentsForInvoice a transaction using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response paymentsForInvoiceRaw(String invoiceId, TransactionPaymentsForInvoiceParams params)
      throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/payments", "invoice-id", invoiceId);
    return get(path, params != null ? params.toQueryParams() : null);
  }

  /**
   * paymentsForInvoice a transaction without params (executes immediately) - returns raw Response.
   */
  Response paymentsForInvoiceRaw(String invoiceId) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/payments", "invoice-id", invoiceId);
    return get(path, null);
  }

  /**
   * paymentsForInvoice a transaction using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response paymentsForInvoiceRaw(String invoiceId, String jsonPayload) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/payments", "invoice-id", invoiceId);
    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public TransactionPaymentsForInvoiceResponse paymentsForInvoice(
      String invoiceId, TransactionPaymentsForInvoiceParams params) throws Exception {
    Response response = paymentsForInvoiceRaw(invoiceId, params);
    return TransactionPaymentsForInvoiceResponse.fromJson(
        response.getBodyAsString(), this, params, invoiceId, response);
  }

  public TransactionPaymentsForInvoiceResponse paymentsForInvoice(String invoiceId)
      throws Exception {
    Response response = paymentsForInvoiceRaw(invoiceId);
    return TransactionPaymentsForInvoiceResponse.fromJson(
        response.getBodyAsString(), this, null, invoiceId, response);
  }

  /** deleteOfflineTransaction a transaction (executes immediately) - returns raw Response. */
  Response deleteOfflineTransactionRaw(String transactionId) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/delete_offline_transaction",
            "transaction-id",
            transactionId);

    return post(path, null);
  }

  /**
   * deleteOfflineTransaction a transaction using immutable params (executes immediately) - returns
   * raw Response.
   */
  Response deleteOfflineTransactionRaw(
      String transactionId, TransactionDeleteOfflineTransactionParams params) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/delete_offline_transaction",
            "transaction-id",
            transactionId);
    return post(path, params.toFormData());
  }

  /**
   * deleteOfflineTransaction a transaction using raw JSON payload (executes immediately) - returns
   * raw Response.
   */
  Response deleteOfflineTransactionRaw(String transactionId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams(
            "/transactions/{transaction-id}/delete_offline_transaction",
            "transaction-id",
            transactionId);
    return postJson(path, jsonPayload);
  }

  public TransactionDeleteOfflineTransactionResponse deleteOfflineTransaction(
      String transactionId, TransactionDeleteOfflineTransactionParams params) throws Exception {
    Response response = deleteOfflineTransactionRaw(transactionId, params);
    return TransactionDeleteOfflineTransactionResponse.fromJson(
        response.getBodyAsString(), response);
  }
}
