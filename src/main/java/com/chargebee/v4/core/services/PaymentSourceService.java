/*
 * This file is auto-generated by Chargebee.
 * For more information on how to make changes to this file, please see the README.
 * Reach out to dx@chargebee.com for any questions.
 * Copyright 2025 Chargebee Inc.
 */

package com.chargebee.v4.core.services;

import com.chargebee.v4.client.ChargebeeClient;
import com.chargebee.v4.client.request.RequestOptions;
import com.chargebee.v4.transport.Response;

import com.chargebee.v4.core.models.paymentSource.params.PaymentSourceCreateUsingPermanentTokenParams;

import com.chargebee.v4.core.models.paymentSource.params.PaymentSourceCreateCardParams;

import com.chargebee.v4.core.models.paymentSource.params.PaymentSourceVerifyBankAccountParams;

import com.chargebee.v4.core.models.paymentSource.params.PaymentSourceListParams;

import com.chargebee.v4.core.models.paymentSource.params.PaymentSourceExportPaymentSourceParams;

import com.chargebee.v4.core.models.paymentSource.params.PaymentSourceCreateUsingPaymentIntentParams;

import com.chargebee.v4.core.models.paymentSource.params.PaymentSourceCreateVoucherPaymentSourceParams;

import com.chargebee.v4.core.models.paymentSource.params.PaymentSourceCreateUsingTempTokenParams;

import com.chargebee.v4.core.models.paymentSource.params.PaymentSourceUpdateCardParams;

import com.chargebee.v4.core.models.paymentSource.params.PaymentSourceSwitchGatewayAccountParams;

import com.chargebee.v4.core.models.paymentSource.params.PaymentSourceCreateUsingTokenParams;

import com.chargebee.v4.core.models.paymentSource.params.PaymentSourceCreateBankAccountParams;

import com.chargebee.v4.core.models.paymentSource.params.PaymentSourceUpdateBankAccountParams;

import com.chargebee.v4.core.responses.paymentSource.PaymentSourceCreateUsingPermanentTokenResponse;

import com.chargebee.v4.core.responses.paymentSource.PaymentSourceDeleteResponse;

import com.chargebee.v4.core.responses.paymentSource.PaymentSourceCreateCardResponse;

import com.chargebee.v4.core.responses.paymentSource.PaymentSourceVerifyBankAccountResponse;

import com.chargebee.v4.core.responses.paymentSource.PaymentSourceListResponse;

import com.chargebee.v4.core.responses.paymentSource.PaymentSourceExportPaymentSourceResponse;

import com.chargebee.v4.core.responses.paymentSource.PaymentSourceCreateUsingPaymentIntentResponse;

import com.chargebee.v4.core.responses.paymentSource.PaymentSourceAgreementPdfResponse;

import com.chargebee.v4.core.responses.paymentSource.PaymentSourceRetrieveResponse;

import com.chargebee.v4.core.responses.paymentSource.PaymentSourceCreateVoucherPaymentSourceResponse;

import com.chargebee.v4.core.responses.paymentSource.PaymentSourceCreateUsingTempTokenResponse;

import com.chargebee.v4.core.responses.paymentSource.PaymentSourceUpdateCardResponse;

import com.chargebee.v4.core.responses.paymentSource.PaymentSourceSwitchGatewayAccountResponse;

import com.chargebee.v4.core.responses.paymentSource.PaymentSourceCreateUsingTokenResponse;

import com.chargebee.v4.core.responses.paymentSource.PaymentSourceDeleteLocalResponse;

import com.chargebee.v4.core.responses.paymentSource.PaymentSourceCreateBankAccountResponse;

import com.chargebee.v4.core.responses.paymentSource.PaymentSourceUpdateBankAccountResponse;

public final class PaymentSourceService extends BaseService<PaymentSourceService> {

  private final ServiceConfig config;

  public PaymentSourceService(ChargebeeClient client) {
    super(client);
    this.config = ServiceConfig.defaultConfig();
  }

  private PaymentSourceService(ChargebeeClient client, RequestOptions options) {
    super(client, options);
    this.config = ServiceConfig.defaultConfig();
  }

  private PaymentSourceService(
      ChargebeeClient client, RequestOptions options, ServiceConfig config) {
    super(client, options);
    this.config = config;
  }

  @Override
  PaymentSourceService with(RequestOptions newOptions) {
    return new PaymentSourceService(client, newOptions, config);
  }

  /**
   * Apply per-request options for this service instance. Users can chain .withOptions or .options
   * to set headers and other options.
   */
  public PaymentSourceService withOptions(RequestOptions options) {
    return with(options);
  }

  // === Operations ===

  /**
   * createUsingPermanentToken a paymentSource using immutable params (executes immediately) -
   * returns raw Response.
   */
  Response createUsingPermanentTokenRaw(PaymentSourceCreateUsingPermanentTokenParams params)
      throws Exception {

    return post(
        "/payment_sources/create_using_permanent_token",
        params != null ? params.toFormData() : null);
  }

  /**
   * createUsingPermanentToken a paymentSource using raw JSON payload (executes immediately) -
   * returns raw Response.
   */
  Response createUsingPermanentTokenRaw(String jsonPayload) throws Exception {

    return postJson("/payment_sources/create_using_permanent_token", jsonPayload);
  }

  public PaymentSourceCreateUsingPermanentTokenResponse createUsingPermanentToken(
      PaymentSourceCreateUsingPermanentTokenParams params) throws Exception {
    Response response = createUsingPermanentTokenRaw(params);

    return parseResponse(response, PaymentSourceCreateUsingPermanentTokenResponse.class);
  }

  /** delete a paymentSource (executes immediately) - returns raw Response. */
  Response deleteRaw(String custPaymentSourceId) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/delete",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  public PaymentSourceDeleteResponse delete(String custPaymentSourceId) throws Exception {
    Response response = deleteRaw(custPaymentSourceId);
    return parseResponse(response, PaymentSourceDeleteResponse.class);
  }

  /**
   * createCard a paymentSource using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response createCardRaw(PaymentSourceCreateCardParams params) throws Exception {

    return post("/payment_sources/create_card", params != null ? params.toFormData() : null);
  }

  /**
   * createCard a paymentSource using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response createCardRaw(String jsonPayload) throws Exception {

    return postJson("/payment_sources/create_card", jsonPayload);
  }

  public PaymentSourceCreateCardResponse createCard(PaymentSourceCreateCardParams params)
      throws Exception {
    Response response = createCardRaw(params);

    return parseResponse(response, PaymentSourceCreateCardResponse.class);
  }

  /** verifyBankAccount a paymentSource (executes immediately) - returns raw Response. */
  Response verifyBankAccountRaw(String custPaymentSourceId) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/verify_bank_account",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  /**
   * verifyBankAccount a paymentSource using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response verifyBankAccountRaw(
      String custPaymentSourceId, PaymentSourceVerifyBankAccountParams params) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/verify_bank_account",
            "cust-payment-source-id",
            custPaymentSourceId);
    return post(path, params.toFormData());
  }

  /**
   * verifyBankAccount a paymentSource using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response verifyBankAccountRaw(String custPaymentSourceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/verify_bank_account",
            "cust-payment-source-id",
            custPaymentSourceId);
    return postJson(path, jsonPayload);
  }

  public PaymentSourceVerifyBankAccountResponse verifyBankAccount(
      String custPaymentSourceId, PaymentSourceVerifyBankAccountParams params) throws Exception {
    Response response = verifyBankAccountRaw(custPaymentSourceId, params);
    return parseResponse(response, PaymentSourceVerifyBankAccountResponse.class);
  }

  /** list a paymentSource using immutable params (executes immediately) - returns raw Response. */
  Response listRaw(PaymentSourceListParams params) throws Exception {

    return get("/payment_sources", params != null ? params.toQueryParams() : null);
  }

  /** list a paymentSource without params (executes immediately) - returns raw Response. */
  Response listRaw() throws Exception {

    return get("/payment_sources", null);
  }

  /** list a paymentSource using raw JSON payload (executes immediately) - returns raw Response. */
  Response listRaw(String jsonPayload) throws Exception {

    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public PaymentSourceListResponse list(PaymentSourceListParams params) throws Exception {
    Response response = listRaw(params);

    return PaymentSourceListResponse.fromJson(response.getBodyAsString(), this, params);
  }

  public PaymentSourceListResponse list() throws Exception {
    Response response = listRaw();
    return PaymentSourceListResponse.fromJson(response.getBodyAsString(), this, null);
  }

  /** exportPaymentSource a paymentSource (executes immediately) - returns raw Response. */
  Response exportPaymentSourceRaw(String custPaymentSourceId) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/export_payment_source",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  /**
   * exportPaymentSource a paymentSource using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response exportPaymentSourceRaw(
      String custPaymentSourceId, PaymentSourceExportPaymentSourceParams params) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/export_payment_source",
            "cust-payment-source-id",
            custPaymentSourceId);
    return post(path, params.toFormData());
  }

  /**
   * exportPaymentSource a paymentSource using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response exportPaymentSourceRaw(String custPaymentSourceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/export_payment_source",
            "cust-payment-source-id",
            custPaymentSourceId);
    return postJson(path, jsonPayload);
  }

  public PaymentSourceExportPaymentSourceResponse exportPaymentSource(
      String custPaymentSourceId, PaymentSourceExportPaymentSourceParams params) throws Exception {
    Response response = exportPaymentSourceRaw(custPaymentSourceId, params);
    return parseResponse(response, PaymentSourceExportPaymentSourceResponse.class);
  }

  /**
   * createUsingPaymentIntent a paymentSource using immutable params (executes immediately) -
   * returns raw Response.
   */
  Response createUsingPaymentIntentRaw(PaymentSourceCreateUsingPaymentIntentParams params)
      throws Exception {

    return post(
        "/payment_sources/create_using_payment_intent",
        params != null ? params.toFormData() : null);
  }

  /**
   * createUsingPaymentIntent a paymentSource using raw JSON payload (executes immediately) -
   * returns raw Response.
   */
  Response createUsingPaymentIntentRaw(String jsonPayload) throws Exception {

    return postJson("/payment_sources/create_using_payment_intent", jsonPayload);
  }

  public PaymentSourceCreateUsingPaymentIntentResponse createUsingPaymentIntent(
      PaymentSourceCreateUsingPaymentIntentParams params) throws Exception {
    Response response = createUsingPaymentIntentRaw(params);

    return parseResponse(response, PaymentSourceCreateUsingPaymentIntentResponse.class);
  }

  /** agreementPdf a paymentSource (executes immediately) - returns raw Response. */
  Response agreementPdfRaw(String custPaymentSourceId) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/agreement_pdf",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  public PaymentSourceAgreementPdfResponse agreementPdf(String custPaymentSourceId)
      throws Exception {
    Response response = agreementPdfRaw(custPaymentSourceId);
    return parseResponse(response, PaymentSourceAgreementPdfResponse.class);
  }

  /** retrieve a paymentSource (executes immediately) - returns raw Response. */
  Response retrieveRaw(String custPaymentSourceId) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}",
            "cust-payment-source-id",
            custPaymentSourceId);

    return get(path, null);
  }

  public PaymentSourceRetrieveResponse retrieve(String custPaymentSourceId) throws Exception {
    Response response = retrieveRaw(custPaymentSourceId);
    return parseResponse(response, PaymentSourceRetrieveResponse.class);
  }

  /**
   * createVoucherPaymentSource a paymentSource using immutable params (executes immediately) -
   * returns raw Response.
   */
  Response createVoucherPaymentSourceRaw(PaymentSourceCreateVoucherPaymentSourceParams params)
      throws Exception {

    return post(
        "/payment_sources/create_voucher_payment_source",
        params != null ? params.toFormData() : null);
  }

  /**
   * createVoucherPaymentSource a paymentSource using raw JSON payload (executes immediately) -
   * returns raw Response.
   */
  Response createVoucherPaymentSourceRaw(String jsonPayload) throws Exception {

    return postJson("/payment_sources/create_voucher_payment_source", jsonPayload);
  }

  public PaymentSourceCreateVoucherPaymentSourceResponse createVoucherPaymentSource(
      PaymentSourceCreateVoucherPaymentSourceParams params) throws Exception {
    Response response = createVoucherPaymentSourceRaw(params);

    return parseResponse(response, PaymentSourceCreateVoucherPaymentSourceResponse.class);
  }

  /**
   * createUsingTempToken a paymentSource using immutable params (executes immediately) - returns
   * raw Response.
   */
  Response createUsingTempTokenRaw(PaymentSourceCreateUsingTempTokenParams params)
      throws Exception {

    return post(
        "/payment_sources/create_using_temp_token", params != null ? params.toFormData() : null);
  }

  /**
   * createUsingTempToken a paymentSource using raw JSON payload (executes immediately) - returns
   * raw Response.
   */
  Response createUsingTempTokenRaw(String jsonPayload) throws Exception {

    return postJson("/payment_sources/create_using_temp_token", jsonPayload);
  }

  public PaymentSourceCreateUsingTempTokenResponse createUsingTempToken(
      PaymentSourceCreateUsingTempTokenParams params) throws Exception {
    Response response = createUsingTempTokenRaw(params);

    return parseResponse(response, PaymentSourceCreateUsingTempTokenResponse.class);
  }

  /** updateCard a paymentSource (executes immediately) - returns raw Response. */
  Response updateCardRaw(String custPaymentSourceId) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/update_card",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  /**
   * updateCard a paymentSource using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response updateCardRaw(String custPaymentSourceId, PaymentSourceUpdateCardParams params)
      throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/update_card",
            "cust-payment-source-id",
            custPaymentSourceId);
    return post(path, params.toFormData());
  }

  /**
   * updateCard a paymentSource using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response updateCardRaw(String custPaymentSourceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/update_card",
            "cust-payment-source-id",
            custPaymentSourceId);
    return postJson(path, jsonPayload);
  }

  public PaymentSourceUpdateCardResponse updateCard(
      String custPaymentSourceId, PaymentSourceUpdateCardParams params) throws Exception {
    Response response = updateCardRaw(custPaymentSourceId, params);
    return parseResponse(response, PaymentSourceUpdateCardResponse.class);
  }

  /** switchGatewayAccount a paymentSource (executes immediately) - returns raw Response. */
  Response switchGatewayAccountRaw(String custPaymentSourceId) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/switch_gateway_account",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  /**
   * switchGatewayAccount a paymentSource using immutable params (executes immediately) - returns
   * raw Response.
   */
  Response switchGatewayAccountRaw(
      String custPaymentSourceId, PaymentSourceSwitchGatewayAccountParams params) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/switch_gateway_account",
            "cust-payment-source-id",
            custPaymentSourceId);
    return post(path, params.toFormData());
  }

  /**
   * switchGatewayAccount a paymentSource using raw JSON payload (executes immediately) - returns
   * raw Response.
   */
  Response switchGatewayAccountRaw(String custPaymentSourceId, String jsonPayload)
      throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/switch_gateway_account",
            "cust-payment-source-id",
            custPaymentSourceId);
    return postJson(path, jsonPayload);
  }

  public PaymentSourceSwitchGatewayAccountResponse switchGatewayAccount(
      String custPaymentSourceId, PaymentSourceSwitchGatewayAccountParams params) throws Exception {
    Response response = switchGatewayAccountRaw(custPaymentSourceId, params);
    return parseResponse(response, PaymentSourceSwitchGatewayAccountResponse.class);
  }

  /**
   * createUsingToken a paymentSource using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response createUsingTokenRaw(PaymentSourceCreateUsingTokenParams params) throws Exception {

    return post("/payment_sources/create_using_token", params != null ? params.toFormData() : null);
  }

  /**
   * createUsingToken a paymentSource using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response createUsingTokenRaw(String jsonPayload) throws Exception {

    return postJson("/payment_sources/create_using_token", jsonPayload);
  }

  public PaymentSourceCreateUsingTokenResponse createUsingToken(
      PaymentSourceCreateUsingTokenParams params) throws Exception {
    Response response = createUsingTokenRaw(params);

    return parseResponse(response, PaymentSourceCreateUsingTokenResponse.class);
  }

  /** deleteLocal a paymentSource (executes immediately) - returns raw Response. */
  Response deleteLocalRaw(String custPaymentSourceId) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/delete_local",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  public PaymentSourceDeleteLocalResponse deleteLocal(String custPaymentSourceId) throws Exception {
    Response response = deleteLocalRaw(custPaymentSourceId);
    return parseResponse(response, PaymentSourceDeleteLocalResponse.class);
  }

  /**
   * createBankAccount a paymentSource using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response createBankAccountRaw(PaymentSourceCreateBankAccountParams params) throws Exception {

    return post(
        "/payment_sources/create_bank_account", params != null ? params.toFormData() : null);
  }

  /**
   * createBankAccount a paymentSource using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response createBankAccountRaw(String jsonPayload) throws Exception {

    return postJson("/payment_sources/create_bank_account", jsonPayload);
  }

  public PaymentSourceCreateBankAccountResponse createBankAccount(
      PaymentSourceCreateBankAccountParams params) throws Exception {
    Response response = createBankAccountRaw(params);

    return parseResponse(response, PaymentSourceCreateBankAccountResponse.class);
  }

  /** updateBankAccount a paymentSource (executes immediately) - returns raw Response. */
  Response updateBankAccountRaw(String custPaymentSourceId) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/update_bank_account",
            "cust-payment-source-id",
            custPaymentSourceId);

    return post(path, null);
  }

  /**
   * updateBankAccount a paymentSource using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response updateBankAccountRaw(
      String custPaymentSourceId, PaymentSourceUpdateBankAccountParams params) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/update_bank_account",
            "cust-payment-source-id",
            custPaymentSourceId);
    return post(path, params.toFormData());
  }

  /**
   * updateBankAccount a paymentSource using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response updateBankAccountRaw(String custPaymentSourceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams(
            "/payment_sources/{cust-payment-source-id}/update_bank_account",
            "cust-payment-source-id",
            custPaymentSourceId);
    return postJson(path, jsonPayload);
  }

  public PaymentSourceUpdateBankAccountResponse updateBankAccount(
      String custPaymentSourceId, PaymentSourceUpdateBankAccountParams params) throws Exception {
    Response response = updateBankAccountRaw(custPaymentSourceId, params);
    return parseResponse(response, PaymentSourceUpdateBankAccountResponse.class);
  }
}
