/*
 * This file is auto-generated by Chargebee.
 * For more information on how to make changes to this file, please see the README.
 * Reach out to dx@chargebee.com for any questions.
 * Copyright 2025 Chargebee Inc.
 */
package com.chargebee.v4.models.customer.params;

import com.chargebee.v4.internal.Recommended;

import java.util.Collections;
import java.util.LinkedHashMap;
import java.util.Map;
import java.util.List;

public final class CustomerUpdateBillingInfoParams {

  private final String vatNumber;

  private final String vatNumberPrefix;

  private final String entityIdentifierScheme;

  private final String entityIdentifierStandard;

  private final Boolean registeredForGst;

  private final Boolean businessCustomerWithoutVatNumber;

  private final Boolean isEinvoiceEnabled;

  private final EinvoicingMethod einvoicingMethod;

  private final BillingAddressParams billingAddress;

  private final List<EntityIdentifiersParams> entityIdentifiers;

  private final List<TaxProvidersFieldsParams> taxProvidersFields;

  private final Map<String, Object> consentFields;

  private CustomerUpdateBillingInfoParams(CustomerUpdateBillingInfoBuilder builder) {

    this.vatNumber = builder.vatNumber;

    this.vatNumberPrefix = builder.vatNumberPrefix;

    this.entityIdentifierScheme = builder.entityIdentifierScheme;

    this.entityIdentifierStandard = builder.entityIdentifierStandard;

    this.registeredForGst = builder.registeredForGst;

    this.businessCustomerWithoutVatNumber = builder.businessCustomerWithoutVatNumber;

    this.isEinvoiceEnabled = builder.isEinvoiceEnabled;

    this.einvoicingMethod = builder.einvoicingMethod;

    this.billingAddress = builder.billingAddress;

    this.entityIdentifiers = builder.entityIdentifiers;

    this.taxProvidersFields = builder.taxProvidersFields;

    this.consentFields =
        builder.consentFields.isEmpty()
            ? Collections.emptyMap()
            : Collections.unmodifiableMap(new LinkedHashMap<>(builder.consentFields));
  }

  public String getVatNumber() {
    return vatNumber;
  }

  public String getVatNumberPrefix() {
    return vatNumberPrefix;
  }

  public String getEntityIdentifierScheme() {
    return entityIdentifierScheme;
  }

  public String getEntityIdentifierStandard() {
    return entityIdentifierStandard;
  }

  public Boolean getRegisteredForGst() {
    return registeredForGst;
  }

  public Boolean getBusinessCustomerWithoutVatNumber() {
    return businessCustomerWithoutVatNumber;
  }

  public Boolean getIsEinvoiceEnabled() {
    return isEinvoiceEnabled;
  }

  public EinvoicingMethod getEinvoicingMethod() {
    return einvoicingMethod;
  }

  public BillingAddressParams getBillingAddress() {
    return billingAddress;
  }

  public List<EntityIdentifiersParams> getEntityIdentifiers() {
    return entityIdentifiers;
  }

  public List<TaxProvidersFieldsParams> getTaxProvidersFields() {
    return taxProvidersFields;
  }

  public Map<String, Object> consentFields() {
    return consentFields;
  }

  /** Get the form data for this request. */
  public Map<String, Object> toFormData() {
    Map<String, Object> formData = new LinkedHashMap<>();

    if (this.vatNumber != null) {

      formData.put("vat_number", this.vatNumber);
    }

    if (this.vatNumberPrefix != null) {

      formData.put("vat_number_prefix", this.vatNumberPrefix);
    }

    if (this.entityIdentifierScheme != null) {

      formData.put("entity_identifier_scheme", this.entityIdentifierScheme);
    }

    if (this.entityIdentifierStandard != null) {

      formData.put("entity_identifier_standard", this.entityIdentifierStandard);
    }

    if (this.registeredForGst != null) {

      formData.put("registered_for_gst", this.registeredForGst);
    }

    if (this.businessCustomerWithoutVatNumber != null) {

      formData.put("business_customer_without_vat_number", this.businessCustomerWithoutVatNumber);
    }

    if (this.isEinvoiceEnabled != null) {

      formData.put("is_einvoice_enabled", this.isEinvoiceEnabled);
    }

    if (this.einvoicingMethod != null) {

      formData.put("einvoicing_method", this.einvoicingMethod);
    }

    if (this.billingAddress != null) {

      // Single object
      Map<String, Object> nestedData = this.billingAddress.toFormData();
      for (Map.Entry<String, Object> entry : nestedData.entrySet()) {
        String nestedKey = "billing_address[" + entry.getKey() + "]";
        formData.put(nestedKey, entry.getValue());
      }
    }

    if (this.entityIdentifiers != null) {

      // List of objects
      for (int i = 0; i < this.entityIdentifiers.size(); i++) {
        EntityIdentifiersParams item = this.entityIdentifiers.get(i);
        if (item != null) {
          Map<String, Object> itemData = item.toFormData();
          for (Map.Entry<String, Object> entry : itemData.entrySet()) {
            String indexedKey = "entity_identifiers[" + entry.getKey() + "][" + i + "]";
            formData.put(indexedKey, entry.getValue());
          }
        }
      }
    }

    if (this.taxProvidersFields != null) {

      // List of objects
      for (int i = 0; i < this.taxProvidersFields.size(); i++) {
        TaxProvidersFieldsParams item = this.taxProvidersFields.get(i);
        if (item != null) {
          Map<String, Object> itemData = item.toFormData();
          for (Map.Entry<String, Object> entry : itemData.entrySet()) {
            String indexedKey = "tax_providers_fields[" + entry.getKey() + "][" + i + "]";
            formData.put(indexedKey, entry.getValue());
          }
        }
      }
    }

    formData.putAll(consentFields);

    return formData;
  }

  /** Create a new builder for CustomerUpdateBillingInfoParams. */
  @Recommended(reason = "Preferred for reusability, validation, and LLM-friendliness")
  public static CustomerUpdateBillingInfoBuilder builder() {
    return new CustomerUpdateBillingInfoBuilder();
  }

  public static final class CustomerUpdateBillingInfoBuilder {

    private String vatNumber;

    private String vatNumberPrefix;

    private String entityIdentifierScheme;

    private String entityIdentifierStandard;

    private Boolean registeredForGst;

    private Boolean businessCustomerWithoutVatNumber;

    private Boolean isEinvoiceEnabled;

    private EinvoicingMethod einvoicingMethod;

    private BillingAddressParams billingAddress;

    private List<EntityIdentifiersParams> entityIdentifiers;

    private List<TaxProvidersFieldsParams> taxProvidersFields;

    private Map<String, Object> consentFields = new LinkedHashMap<>();

    private CustomerUpdateBillingInfoBuilder() {}

    public CustomerUpdateBillingInfoBuilder vatNumber(String value) {
      this.vatNumber = value;
      return this;
    }

    public CustomerUpdateBillingInfoBuilder vatNumberPrefix(String value) {
      this.vatNumberPrefix = value;
      return this;
    }

    public CustomerUpdateBillingInfoBuilder entityIdentifierScheme(String value) {
      this.entityIdentifierScheme = value;
      return this;
    }

    public CustomerUpdateBillingInfoBuilder entityIdentifierStandard(String value) {
      this.entityIdentifierStandard = value;
      return this;
    }

    public CustomerUpdateBillingInfoBuilder registeredForGst(Boolean value) {
      this.registeredForGst = value;
      return this;
    }

    public CustomerUpdateBillingInfoBuilder businessCustomerWithoutVatNumber(Boolean value) {
      this.businessCustomerWithoutVatNumber = value;
      return this;
    }

    public CustomerUpdateBillingInfoBuilder isEinvoiceEnabled(Boolean value) {
      this.isEinvoiceEnabled = value;
      return this;
    }

    public CustomerUpdateBillingInfoBuilder einvoicingMethod(EinvoicingMethod value) {
      this.einvoicingMethod = value;
      return this;
    }

    public CustomerUpdateBillingInfoBuilder billingAddress(BillingAddressParams value) {
      this.billingAddress = value;
      return this;
    }

    public CustomerUpdateBillingInfoBuilder entityIdentifiers(List<EntityIdentifiersParams> value) {
      this.entityIdentifiers = value;
      return this;
    }

    public CustomerUpdateBillingInfoBuilder taxProvidersFields(
        List<TaxProvidersFieldsParams> value) {
      this.taxProvidersFields = value;
      return this;
    }

    /**
     * Add a consent field to the request. Consent fields must start with "cs_". Consent fields
     * typically hold boolean values or options.
     *
     * @param fieldName the name of the consent field (e.g., "cs_marketing_consent")
     * @param value the value of the consent field (typically Boolean or String for options)
     * @return this builder
     * @throws IllegalArgumentException if fieldName doesn't start with "cs_"
     */
    public CustomerUpdateBillingInfoBuilder consentField(String fieldName, Object value) {
      if (fieldName == null || !fieldName.startsWith("cs_")) {
        throw new IllegalArgumentException("Consent field name must start with 'cs_'");
      }
      this.consentFields.put(fieldName, value);
      return this;
    }

    /**
     * Add a boolean consent field to the request. Consent fields must start with "cs_".
     *
     * @param fieldName the name of the consent field (e.g., "cs_marketing_consent")
     * @param value the boolean value of the consent field
     * @return this builder
     * @throws IllegalArgumentException if fieldName doesn't start with "cs_"
     */
    public CustomerUpdateBillingInfoBuilder consentField(String fieldName, Boolean value) {
      if (fieldName == null || !fieldName.startsWith("cs_")) {
        throw new IllegalArgumentException("Consent field name must start with 'cs_'");
      }
      this.consentFields.put(fieldName, value);
      return this;
    }

    /**
     * Add multiple consent fields to the request. All field names must start with "cs_".
     *
     * @param consentFields map of consent field names to values
     * @return this builder
     * @throws IllegalArgumentException if any field name doesn't start with "cs_"
     */
    public CustomerUpdateBillingInfoBuilder consentFields(Map<String, Object> consentFields) {
      if (consentFields != null) {
        for (Map.Entry<String, Object> entry : consentFields.entrySet()) {
          if (entry.getKey() == null || !entry.getKey().startsWith("cs_")) {
            throw new IllegalArgumentException(
                "Consent field name must start with 'cs_': " + entry.getKey());
          }
          this.consentFields.put(entry.getKey(), entry.getValue());
        }
      }
      return this;
    }

    public CustomerUpdateBillingInfoParams build() {
      return new CustomerUpdateBillingInfoParams(this);
    }
  }

  public enum EinvoicingMethod {
    AUTOMATIC("automatic"),

    MANUAL("manual"),

    SITE_DEFAULT("site_default"),

    /** An enum member indicating that EinvoicingMethod was instantiated with an unknown value. */
    _UNKNOWN(null);
    private final String value;

    EinvoicingMethod(String value) {
      this.value = value;
    }

    public String getValue() {
      return value;
    }

    public static EinvoicingMethod fromString(String value) {
      if (value == null) return _UNKNOWN;
      for (EinvoicingMethod enumValue : EinvoicingMethod.values()) {
        if (enumValue.value != null && enumValue.value.equals(value)) {
          return enumValue;
        }
      }
      return _UNKNOWN;
    }
  }

  public static final class BillingAddressParams {

    private final String firstName;

    private final String lastName;

    private final String email;

    private final String company;

    private final String phone;

    private final String line1;

    private final String line2;

    private final String line3;

    private final String city;

    private final String stateCode;

    private final String state;

    private final String zip;

    private final String country;

    private final ValidationStatus validationStatus;

    private BillingAddressParams(BillingAddressBuilder builder) {

      this.firstName = builder.firstName;

      this.lastName = builder.lastName;

      this.email = builder.email;

      this.company = builder.company;

      this.phone = builder.phone;

      this.line1 = builder.line1;

      this.line2 = builder.line2;

      this.line3 = builder.line3;

      this.city = builder.city;

      this.stateCode = builder.stateCode;

      this.state = builder.state;

      this.zip = builder.zip;

      this.country = builder.country;

      this.validationStatus = builder.validationStatus;
    }

    public String getFirstName() {
      return firstName;
    }

    public String getLastName() {
      return lastName;
    }

    public String getEmail() {
      return email;
    }

    public String getCompany() {
      return company;
    }

    public String getPhone() {
      return phone;
    }

    public String getLine1() {
      return line1;
    }

    public String getLine2() {
      return line2;
    }

    public String getLine3() {
      return line3;
    }

    public String getCity() {
      return city;
    }

    public String getStateCode() {
      return stateCode;
    }

    public String getState() {
      return state;
    }

    public String getZip() {
      return zip;
    }

    public String getCountry() {
      return country;
    }

    public ValidationStatus getValidationStatus() {
      return validationStatus;
    }

    /** Get the form data for this request. */
    public Map<String, Object> toFormData() {
      Map<String, Object> formData = new LinkedHashMap<>();

      if (this.firstName != null) {

        formData.put("first_name", this.firstName);
      }

      if (this.lastName != null) {

        formData.put("last_name", this.lastName);
      }

      if (this.email != null) {

        formData.put("email", this.email);
      }

      if (this.company != null) {

        formData.put("company", this.company);
      }

      if (this.phone != null) {

        formData.put("phone", this.phone);
      }

      if (this.line1 != null) {

        formData.put("line1", this.line1);
      }

      if (this.line2 != null) {

        formData.put("line2", this.line2);
      }

      if (this.line3 != null) {

        formData.put("line3", this.line3);
      }

      if (this.city != null) {

        formData.put("city", this.city);
      }

      if (this.stateCode != null) {

        formData.put("state_code", this.stateCode);
      }

      if (this.state != null) {

        formData.put("state", this.state);
      }

      if (this.zip != null) {

        formData.put("zip", this.zip);
      }

      if (this.country != null) {

        formData.put("country", this.country);
      }

      if (this.validationStatus != null) {

        formData.put("validation_status", this.validationStatus);
      }

      return formData;
    }

    /** Create a new builder for BillingAddressParams. */
    @Recommended(reason = "Preferred for reusability, validation, and LLM-friendliness")
    public static BillingAddressBuilder builder() {
      return new BillingAddressBuilder();
    }

    public static final class BillingAddressBuilder {

      private String firstName;

      private String lastName;

      private String email;

      private String company;

      private String phone;

      private String line1;

      private String line2;

      private String line3;

      private String city;

      private String stateCode;

      private String state;

      private String zip;

      private String country;

      private ValidationStatus validationStatus;

      private BillingAddressBuilder() {}

      public BillingAddressBuilder firstName(String value) {
        this.firstName = value;
        return this;
      }

      public BillingAddressBuilder lastName(String value) {
        this.lastName = value;
        return this;
      }

      public BillingAddressBuilder email(String value) {
        this.email = value;
        return this;
      }

      public BillingAddressBuilder company(String value) {
        this.company = value;
        return this;
      }

      public BillingAddressBuilder phone(String value) {
        this.phone = value;
        return this;
      }

      public BillingAddressBuilder line1(String value) {
        this.line1 = value;
        return this;
      }

      public BillingAddressBuilder line2(String value) {
        this.line2 = value;
        return this;
      }

      public BillingAddressBuilder line3(String value) {
        this.line3 = value;
        return this;
      }

      public BillingAddressBuilder city(String value) {
        this.city = value;
        return this;
      }

      public BillingAddressBuilder stateCode(String value) {
        this.stateCode = value;
        return this;
      }

      public BillingAddressBuilder state(String value) {
        this.state = value;
        return this;
      }

      public BillingAddressBuilder zip(String value) {
        this.zip = value;
        return this;
      }

      public BillingAddressBuilder country(String value) {
        this.country = value;
        return this;
      }

      public BillingAddressBuilder validationStatus(ValidationStatus value) {
        this.validationStatus = value;
        return this;
      }

      public BillingAddressParams build() {
        return new BillingAddressParams(this);
      }
    }

    public enum ValidationStatus {
      NOT_VALIDATED("not_validated"),

      VALID("valid"),

      PARTIALLY_VALID("partially_valid"),

      INVALID("invalid"),

      /** An enum member indicating that ValidationStatus was instantiated with an unknown value. */
      _UNKNOWN(null);
      private final String value;

      ValidationStatus(String value) {
        this.value = value;
      }

      public String getValue() {
        return value;
      }

      public static ValidationStatus fromString(String value) {
        if (value == null) return _UNKNOWN;
        for (ValidationStatus enumValue : ValidationStatus.values()) {
          if (enumValue.value != null && enumValue.value.equals(value)) {
            return enumValue;
          }
        }
        return _UNKNOWN;
      }
    }
  }

  public static final class EntityIdentifiersParams {

    private final String id;

    private final String scheme;

    private final String value;

    private final Operation operation;

    private final String standard;

    private EntityIdentifiersParams(EntityIdentifiersBuilder builder) {

      this.id = builder.id;

      this.scheme = builder.scheme;

      this.value = builder.value;

      this.operation = builder.operation;

      this.standard = builder.standard;
    }

    public String getId() {
      return id;
    }

    public String getScheme() {
      return scheme;
    }

    public String getValue() {
      return value;
    }

    public Operation getOperation() {
      return operation;
    }

    public String getStandard() {
      return standard;
    }

    /** Get the form data for this request. */
    public Map<String, Object> toFormData() {
      Map<String, Object> formData = new LinkedHashMap<>();

      if (this.id != null) {

        formData.put("id", this.id);
      }

      if (this.scheme != null) {

        formData.put("scheme", this.scheme);
      }

      if (this.value != null) {

        formData.put("value", this.value);
      }

      if (this.operation != null) {

        formData.put("operation", this.operation);
      }

      if (this.standard != null) {

        formData.put("standard", this.standard);
      }

      return formData;
    }

    /** Create a new builder for EntityIdentifiersParams. */
    @Recommended(reason = "Preferred for reusability, validation, and LLM-friendliness")
    public static EntityIdentifiersBuilder builder() {
      return new EntityIdentifiersBuilder();
    }

    public static final class EntityIdentifiersBuilder {

      private String id;

      private String scheme;

      private String value;

      private Operation operation;

      private String standard;

      private EntityIdentifiersBuilder() {}

      public EntityIdentifiersBuilder id(String value) {
        this.id = value;
        return this;
      }

      public EntityIdentifiersBuilder scheme(String value) {
        this.scheme = value;
        return this;
      }

      public EntityIdentifiersBuilder value(String value) {
        this.value = value;
        return this;
      }

      public EntityIdentifiersBuilder operation(Operation value) {
        this.operation = value;
        return this;
      }

      public EntityIdentifiersBuilder standard(String value) {
        this.standard = value;
        return this;
      }

      public EntityIdentifiersParams build() {
        return new EntityIdentifiersParams(this);
      }
    }

    public enum Operation {
      CREATE("create"),

      UPDATE("update"),

      DELETE("delete"),

      /** An enum member indicating that Operation was instantiated with an unknown value. */
      _UNKNOWN(null);
      private final String value;

      Operation(String value) {
        this.value = value;
      }

      public String getValue() {
        return value;
      }

      public static Operation fromString(String value) {
        if (value == null) return _UNKNOWN;
        for (Operation enumValue : Operation.values()) {
          if (enumValue.value != null && enumValue.value.equals(value)) {
            return enumValue;
          }
        }
        return _UNKNOWN;
      }
    }
  }

  public static final class TaxProvidersFieldsParams {

    private final String providerName;

    private final String fieldId;

    private final String fieldValue;

    private TaxProvidersFieldsParams(TaxProvidersFieldsBuilder builder) {

      this.providerName = builder.providerName;

      this.fieldId = builder.fieldId;

      this.fieldValue = builder.fieldValue;
    }

    public String getProviderName() {
      return providerName;
    }

    public String getFieldId() {
      return fieldId;
    }

    public String getFieldValue() {
      return fieldValue;
    }

    /** Get the form data for this request. */
    public Map<String, Object> toFormData() {
      Map<String, Object> formData = new LinkedHashMap<>();

      if (this.providerName != null) {

        formData.put("provider_name", this.providerName);
      }

      if (this.fieldId != null) {

        formData.put("field_id", this.fieldId);
      }

      if (this.fieldValue != null) {

        formData.put("field_value", this.fieldValue);
      }

      return formData;
    }

    /** Create a new builder for TaxProvidersFieldsParams. */
    @Recommended(reason = "Preferred for reusability, validation, and LLM-friendliness")
    public static TaxProvidersFieldsBuilder builder() {
      return new TaxProvidersFieldsBuilder();
    }

    public static final class TaxProvidersFieldsBuilder {

      private String providerName;

      private String fieldId;

      private String fieldValue;

      private TaxProvidersFieldsBuilder() {}

      public TaxProvidersFieldsBuilder providerName(String value) {
        this.providerName = value;
        return this;
      }

      public TaxProvidersFieldsBuilder fieldId(String value) {
        this.fieldId = value;
        return this;
      }

      public TaxProvidersFieldsBuilder fieldValue(String value) {
        this.fieldValue = value;
        return this;
      }

      public TaxProvidersFieldsParams build() {
        return new TaxProvidersFieldsParams(this);
      }
    }
  }
}
