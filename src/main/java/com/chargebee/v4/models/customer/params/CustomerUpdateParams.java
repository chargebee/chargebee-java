/*
 * This file is auto-generated by Chargebee.
 * For more information on how to make changes to this file, please see the README.
 * Reach out to dx@chargebee.com for any questions.
 * Copyright 2025 Chargebee Inc.
 */
package com.chargebee.v4.models.customer.params;

import com.chargebee.v4.internal.Recommended;
import com.chargebee.v4.internal.JsonUtil;

import java.util.Collections;
import java.util.LinkedHashMap;
import java.util.Map;
import java.util.List;

public final class CustomerUpdateParams {

  private final String firstName;

  private final String lastName;

  private final String email;

  private final String preferredCurrencyCode;

  private final String phone;

  private final String company;

  private final AutoCollection autoCollection;

  private final Boolean allowDirectDebit;

  private final Integer netTermDays;

  private final Taxability taxability;

  private final List<Object> exemptionDetails;

  private final CustomerType customerType;

  private final String clientProfileId;

  private final TaxjarExemptionCategory taxjarExemptionCategory;

  private final String locale;

  private final EntityCode entityCode;

  private final String exemptNumber;

  private final OfflinePaymentMethod offlinePaymentMethod;

  private final String invoiceNotes;

  private final Boolean autoCloseInvoices;

  private final java.util.Map<String, Object> metaData;

  private final FraudFlag fraudFlag;

  private final Boolean consolidatedInvoicing;

  private final List<TaxProvidersFieldsParams> taxProvidersFields;

  private final Map<String, Object> customFields;

  private CustomerUpdateParams(CustomerUpdateBuilder builder) {

    this.firstName = builder.firstName;

    this.lastName = builder.lastName;

    this.email = builder.email;

    this.preferredCurrencyCode = builder.preferredCurrencyCode;

    this.phone = builder.phone;

    this.company = builder.company;

    this.autoCollection = builder.autoCollection;

    this.allowDirectDebit = builder.allowDirectDebit;

    this.netTermDays = builder.netTermDays;

    this.taxability = builder.taxability;

    this.exemptionDetails = builder.exemptionDetails;

    this.customerType = builder.customerType;

    this.clientProfileId = builder.clientProfileId;

    this.taxjarExemptionCategory = builder.taxjarExemptionCategory;

    this.locale = builder.locale;

    this.entityCode = builder.entityCode;

    this.exemptNumber = builder.exemptNumber;

    this.offlinePaymentMethod = builder.offlinePaymentMethod;

    this.invoiceNotes = builder.invoiceNotes;

    this.autoCloseInvoices = builder.autoCloseInvoices;

    this.metaData = builder.metaData;

    this.fraudFlag = builder.fraudFlag;

    this.consolidatedInvoicing = builder.consolidatedInvoicing;

    this.taxProvidersFields = builder.taxProvidersFields;

    this.customFields =
        builder.customFields.isEmpty()
            ? Collections.emptyMap()
            : Collections.unmodifiableMap(new LinkedHashMap<>(builder.customFields));
  }

  public String getFirstName() {
    return firstName;
  }

  public String getLastName() {
    return lastName;
  }

  public String getEmail() {
    return email;
  }

  public String getPreferredCurrencyCode() {
    return preferredCurrencyCode;
  }

  public String getPhone() {
    return phone;
  }

  public String getCompany() {
    return company;
  }

  public AutoCollection getAutoCollection() {
    return autoCollection;
  }

  public Boolean getAllowDirectDebit() {
    return allowDirectDebit;
  }

  public Integer getNetTermDays() {
    return netTermDays;
  }

  public Taxability getTaxability() {
    return taxability;
  }

  public List<Object> getExemptionDetails() {
    return exemptionDetails;
  }

  public CustomerType getCustomerType() {
    return customerType;
  }

  public String getClientProfileId() {
    return clientProfileId;
  }

  public TaxjarExemptionCategory getTaxjarExemptionCategory() {
    return taxjarExemptionCategory;
  }

  public String getLocale() {
    return locale;
  }

  public EntityCode getEntityCode() {
    return entityCode;
  }

  public String getExemptNumber() {
    return exemptNumber;
  }

  public OfflinePaymentMethod getOfflinePaymentMethod() {
    return offlinePaymentMethod;
  }

  public String getInvoiceNotes() {
    return invoiceNotes;
  }

  public Boolean getAutoCloseInvoices() {
    return autoCloseInvoices;
  }

  public java.util.Map<String, Object> getMetaData() {
    return metaData;
  }

  public FraudFlag getFraudFlag() {
    return fraudFlag;
  }

  public Boolean getConsolidatedInvoicing() {
    return consolidatedInvoicing;
  }

  public List<TaxProvidersFieldsParams> getTaxProvidersFields() {
    return taxProvidersFields;
  }

  public Map<String, Object> customFields() {
    return customFields;
  }

  /** Get the form data for this request. */
  public Map<String, Object> toFormData() {
    Map<String, Object> formData = new LinkedHashMap<>();

    if (this.firstName != null) {

      formData.put("first_name", this.firstName);
    }

    if (this.lastName != null) {

      formData.put("last_name", this.lastName);
    }

    if (this.email != null) {

      formData.put("email", this.email);
    }

    if (this.preferredCurrencyCode != null) {

      formData.put("preferred_currency_code", this.preferredCurrencyCode);
    }

    if (this.phone != null) {

      formData.put("phone", this.phone);
    }

    if (this.company != null) {

      formData.put("company", this.company);
    }

    if (this.autoCollection != null) {

      formData.put("auto_collection", this.autoCollection);
    }

    if (this.allowDirectDebit != null) {

      formData.put("allow_direct_debit", this.allowDirectDebit);
    }

    if (this.netTermDays != null) {

      formData.put("net_term_days", this.netTermDays);
    }

    if (this.taxability != null) {

      formData.put("taxability", this.taxability);
    }

    if (this.exemptionDetails != null) {

      formData.put("exemption_details", JsonUtil.toJson(this.exemptionDetails));
    }

    if (this.customerType != null) {

      formData.put("customer_type", this.customerType);
    }

    if (this.clientProfileId != null) {

      formData.put("client_profile_id", this.clientProfileId);
    }

    if (this.taxjarExemptionCategory != null) {

      formData.put("taxjar_exemption_category", this.taxjarExemptionCategory);
    }

    if (this.locale != null) {

      formData.put("locale", this.locale);
    }

    if (this.entityCode != null) {

      formData.put("entity_code", this.entityCode);
    }

    if (this.exemptNumber != null) {

      formData.put("exempt_number", this.exemptNumber);
    }

    if (this.offlinePaymentMethod != null) {

      formData.put("offline_payment_method", this.offlinePaymentMethod);
    }

    if (this.invoiceNotes != null) {

      formData.put("invoice_notes", this.invoiceNotes);
    }

    if (this.autoCloseInvoices != null) {

      formData.put("auto_close_invoices", this.autoCloseInvoices);
    }

    if (this.metaData != null) {

      formData.put("meta_data", JsonUtil.toJson(this.metaData));
    }

    if (this.fraudFlag != null) {

      formData.put("fraud_flag", this.fraudFlag);
    }

    if (this.consolidatedInvoicing != null) {

      formData.put("consolidated_invoicing", this.consolidatedInvoicing);
    }

    if (this.taxProvidersFields != null) {

      // List of objects
      for (int i = 0; i < this.taxProvidersFields.size(); i++) {
        TaxProvidersFieldsParams item = this.taxProvidersFields.get(i);
        if (item != null) {
          Map<String, Object> itemData = item.toFormData();
          for (Map.Entry<String, Object> entry : itemData.entrySet()) {
            String indexedKey = "tax_providers_fields[" + entry.getKey() + "][" + i + "]";
            formData.put(indexedKey, entry.getValue());
          }
        }
      }
    }

    formData.putAll(customFields);

    return formData;
  }

  /** Create a new builder for CustomerUpdateParams. */
  @Recommended(reason = "Preferred for reusability, validation, and LLM-friendliness")
  public static CustomerUpdateBuilder builder() {
    return new CustomerUpdateBuilder();
  }

  public static final class CustomerUpdateBuilder {

    private String firstName;

    private String lastName;

    private String email;

    private String preferredCurrencyCode;

    private String phone;

    private String company;

    private AutoCollection autoCollection;

    private Boolean allowDirectDebit;

    private Integer netTermDays;

    private Taxability taxability;

    private List<Object> exemptionDetails;

    private CustomerType customerType;

    private String clientProfileId;

    private TaxjarExemptionCategory taxjarExemptionCategory;

    private String locale;

    private EntityCode entityCode;

    private String exemptNumber;

    private OfflinePaymentMethod offlinePaymentMethod;

    private String invoiceNotes;

    private Boolean autoCloseInvoices;

    private java.util.Map<String, Object> metaData;

    private FraudFlag fraudFlag;

    private Boolean consolidatedInvoicing;

    private List<TaxProvidersFieldsParams> taxProvidersFields;

    private Map<String, Object> customFields = new LinkedHashMap<>();

    private CustomerUpdateBuilder() {}

    public CustomerUpdateBuilder firstName(String value) {
      this.firstName = value;
      return this;
    }

    public CustomerUpdateBuilder lastName(String value) {
      this.lastName = value;
      return this;
    }

    public CustomerUpdateBuilder email(String value) {
      this.email = value;
      return this;
    }

    public CustomerUpdateBuilder preferredCurrencyCode(String value) {
      this.preferredCurrencyCode = value;
      return this;
    }

    public CustomerUpdateBuilder phone(String value) {
      this.phone = value;
      return this;
    }

    public CustomerUpdateBuilder company(String value) {
      this.company = value;
      return this;
    }

    public CustomerUpdateBuilder autoCollection(AutoCollection value) {
      this.autoCollection = value;
      return this;
    }

    public CustomerUpdateBuilder allowDirectDebit(Boolean value) {
      this.allowDirectDebit = value;
      return this;
    }

    public CustomerUpdateBuilder netTermDays(Integer value) {
      this.netTermDays = value;
      return this;
    }

    public CustomerUpdateBuilder taxability(Taxability value) {
      this.taxability = value;
      return this;
    }

    public CustomerUpdateBuilder exemptionDetails(List<Object> value) {
      this.exemptionDetails = value;
      return this;
    }

    public CustomerUpdateBuilder customerType(CustomerType value) {
      this.customerType = value;
      return this;
    }

    public CustomerUpdateBuilder clientProfileId(String value) {
      this.clientProfileId = value;
      return this;
    }

    public CustomerUpdateBuilder taxjarExemptionCategory(TaxjarExemptionCategory value) {
      this.taxjarExemptionCategory = value;
      return this;
    }

    public CustomerUpdateBuilder locale(String value) {
      this.locale = value;
      return this;
    }

    public CustomerUpdateBuilder entityCode(EntityCode value) {
      this.entityCode = value;
      return this;
    }

    public CustomerUpdateBuilder exemptNumber(String value) {
      this.exemptNumber = value;
      return this;
    }

    public CustomerUpdateBuilder offlinePaymentMethod(OfflinePaymentMethod value) {
      this.offlinePaymentMethod = value;
      return this;
    }

    public CustomerUpdateBuilder invoiceNotes(String value) {
      this.invoiceNotes = value;
      return this;
    }

    public CustomerUpdateBuilder autoCloseInvoices(Boolean value) {
      this.autoCloseInvoices = value;
      return this;
    }

    public CustomerUpdateBuilder metaData(java.util.Map<String, Object> value) {
      this.metaData = value;
      return this;
    }

    public CustomerUpdateBuilder fraudFlag(FraudFlag value) {
      this.fraudFlag = value;
      return this;
    }

    public CustomerUpdateBuilder consolidatedInvoicing(Boolean value) {
      this.consolidatedInvoicing = value;
      return this;
    }

    public CustomerUpdateBuilder taxProvidersFields(List<TaxProvidersFieldsParams> value) {
      this.taxProvidersFields = value;
      return this;
    }

    /**
     * Add a custom field to the request. Custom fields must start with "cf_".
     *
     * @param fieldName the name of the custom field (e.g., "cf_custom_field_name")
     * @param value the value of the custom field
     * @return this builder
     * @throws IllegalArgumentException if fieldName doesn't start with "cf_"
     */
    public CustomerUpdateBuilder customField(String fieldName, Object value) {
      if (fieldName == null || !fieldName.startsWith("cf_")) {
        throw new IllegalArgumentException("Custom field name must start with 'cf_'");
      }
      this.customFields.put(fieldName, value);
      return this;
    }

    /**
     * Add multiple custom fields to the request. All field names must start with "cf_".
     *
     * @param customFields map of custom field names to values
     * @return this builder
     * @throws IllegalArgumentException if any field name doesn't start with "cf_"
     */
    public CustomerUpdateBuilder customFields(Map<String, Object> customFields) {
      if (customFields != null) {
        for (Map.Entry<String, Object> entry : customFields.entrySet()) {
          if (entry.getKey() == null || !entry.getKey().startsWith("cf_")) {
            throw new IllegalArgumentException(
                "Custom field name must start with 'cf_': " + entry.getKey());
          }
          this.customFields.put(entry.getKey(), entry.getValue());
        }
      }
      return this;
    }

    public CustomerUpdateParams build() {
      return new CustomerUpdateParams(this);
    }
  }

  public enum AutoCollection {
    ON("on"),

    OFF("off"),

    /** An enum member indicating that AutoCollection was instantiated with an unknown value. */
    _UNKNOWN(null);
    private final String value;

    AutoCollection(String value) {
      this.value = value;
    }

    public String getValue() {
      return value;
    }

    public static AutoCollection fromString(String value) {
      if (value == null) return _UNKNOWN;
      for (AutoCollection enumValue : AutoCollection.values()) {
        if (enumValue.value != null && enumValue.value.equals(value)) {
          return enumValue;
        }
      }
      return _UNKNOWN;
    }
  }

  public enum Taxability {
    TAXABLE("taxable"),

    EXEMPT("exempt"),

    /** An enum member indicating that Taxability was instantiated with an unknown value. */
    _UNKNOWN(null);
    private final String value;

    Taxability(String value) {
      this.value = value;
    }

    public String getValue() {
      return value;
    }

    public static Taxability fromString(String value) {
      if (value == null) return _UNKNOWN;
      for (Taxability enumValue : Taxability.values()) {
        if (enumValue.value != null && enumValue.value.equals(value)) {
          return enumValue;
        }
      }
      return _UNKNOWN;
    }
  }

  public enum CustomerType {
    RESIDENTIAL("residential"),

    BUSINESS("business"),

    SENIOR_CITIZEN("senior_citizen"),

    INDUSTRIAL("industrial"),

    /** An enum member indicating that CustomerType was instantiated with an unknown value. */
    _UNKNOWN(null);
    private final String value;

    CustomerType(String value) {
      this.value = value;
    }

    public String getValue() {
      return value;
    }

    public static CustomerType fromString(String value) {
      if (value == null) return _UNKNOWN;
      for (CustomerType enumValue : CustomerType.values()) {
        if (enumValue.value != null && enumValue.value.equals(value)) {
          return enumValue;
        }
      }
      return _UNKNOWN;
    }
  }

  public enum TaxjarExemptionCategory {
    WHOLESALE("wholesale"),

    GOVERNMENT("government"),

    OTHER("other"),

    /**
     * An enum member indicating that TaxjarExemptionCategory was instantiated with an unknown
     * value.
     */
    _UNKNOWN(null);
    private final String value;

    TaxjarExemptionCategory(String value) {
      this.value = value;
    }

    public String getValue() {
      return value;
    }

    public static TaxjarExemptionCategory fromString(String value) {
      if (value == null) return _UNKNOWN;
      for (TaxjarExemptionCategory enumValue : TaxjarExemptionCategory.values()) {
        if (enumValue.value != null && enumValue.value.equals(value)) {
          return enumValue;
        }
      }
      return _UNKNOWN;
    }
  }

  public enum EntityCode {
    A("a"),

    B("b"),

    C("c"),

    D("d"),

    E("e"),

    F("f"),

    G("g"),

    H("h"),

    I("i"),

    J("j"),

    K("k"),

    L("l"),

    M("m"),

    N("n"),

    P("p"),

    Q("q"),

    R("r"),

    MED_1("med1"),

    MED_2("med2"),

    /** An enum member indicating that EntityCode was instantiated with an unknown value. */
    _UNKNOWN(null);
    private final String value;

    EntityCode(String value) {
      this.value = value;
    }

    public String getValue() {
      return value;
    }

    public static EntityCode fromString(String value) {
      if (value == null) return _UNKNOWN;
      for (EntityCode enumValue : EntityCode.values()) {
        if (enumValue.value != null && enumValue.value.equals(value)) {
          return enumValue;
        }
      }
      return _UNKNOWN;
    }
  }

  public enum OfflinePaymentMethod {
    NO_PREFERENCE("no_preference"),

    CASH("cash"),

    CHECK("check"),

    BANK_TRANSFER("bank_transfer"),

    ACH_CREDIT("ach_credit"),

    SEPA_CREDIT("sepa_credit"),

    BOLETO("boleto"),

    US_AUTOMATED_BANK_TRANSFER("us_automated_bank_transfer"),

    EU_AUTOMATED_BANK_TRANSFER("eu_automated_bank_transfer"),

    UK_AUTOMATED_BANK_TRANSFER("uk_automated_bank_transfer"),

    JP_AUTOMATED_BANK_TRANSFER("jp_automated_bank_transfer"),

    MX_AUTOMATED_BANK_TRANSFER("mx_automated_bank_transfer"),

    CUSTOM("custom"),

    /**
     * An enum member indicating that OfflinePaymentMethod was instantiated with an unknown value.
     */
    _UNKNOWN(null);
    private final String value;

    OfflinePaymentMethod(String value) {
      this.value = value;
    }

    public String getValue() {
      return value;
    }

    public static OfflinePaymentMethod fromString(String value) {
      if (value == null) return _UNKNOWN;
      for (OfflinePaymentMethod enumValue : OfflinePaymentMethod.values()) {
        if (enumValue.value != null && enumValue.value.equals(value)) {
          return enumValue;
        }
      }
      return _UNKNOWN;
    }
  }

  public enum FraudFlag {
    SAFE("safe"),

    FRAUDULENT("fraudulent"),

    /** An enum member indicating that FraudFlag was instantiated with an unknown value. */
    _UNKNOWN(null);
    private final String value;

    FraudFlag(String value) {
      this.value = value;
    }

    public String getValue() {
      return value;
    }

    public static FraudFlag fromString(String value) {
      if (value == null) return _UNKNOWN;
      for (FraudFlag enumValue : FraudFlag.values()) {
        if (enumValue.value != null && enumValue.value.equals(value)) {
          return enumValue;
        }
      }
      return _UNKNOWN;
    }
  }

  public static final class TaxProvidersFieldsParams {

    private final String providerName;

    private final String fieldId;

    private final String fieldValue;

    private TaxProvidersFieldsParams(TaxProvidersFieldsBuilder builder) {

      this.providerName = builder.providerName;

      this.fieldId = builder.fieldId;

      this.fieldValue = builder.fieldValue;
    }

    public String getProviderName() {
      return providerName;
    }

    public String getFieldId() {
      return fieldId;
    }

    public String getFieldValue() {
      return fieldValue;
    }

    /** Get the form data for this request. */
    public Map<String, Object> toFormData() {
      Map<String, Object> formData = new LinkedHashMap<>();

      if (this.providerName != null) {

        formData.put("provider_name", this.providerName);
      }

      if (this.fieldId != null) {

        formData.put("field_id", this.fieldId);
      }

      if (this.fieldValue != null) {

        formData.put("field_value", this.fieldValue);
      }

      return formData;
    }

    /** Create a new builder for TaxProvidersFieldsParams. */
    @Recommended(reason = "Preferred for reusability, validation, and LLM-friendliness")
    public static TaxProvidersFieldsBuilder builder() {
      return new TaxProvidersFieldsBuilder();
    }

    public static final class TaxProvidersFieldsBuilder {

      private String providerName;

      private String fieldId;

      private String fieldValue;

      private TaxProvidersFieldsBuilder() {}

      public TaxProvidersFieldsBuilder providerName(String value) {
        this.providerName = value;
        return this;
      }

      public TaxProvidersFieldsBuilder fieldId(String value) {
        this.fieldId = value;
        return this;
      }

      public TaxProvidersFieldsBuilder fieldValue(String value) {
        this.fieldValue = value;
        return this;
      }

      public TaxProvidersFieldsParams build() {
        return new TaxProvidersFieldsParams(this);
      }
    }
  }
}
