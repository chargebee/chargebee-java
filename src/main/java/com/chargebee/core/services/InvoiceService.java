/*
 * This file is auto-generated by Chargebee.
 * For more information on how to make changes to this file, please see the README.
 * Reach out to dx@chargebee.com for any questions.
 * Copyright 2025 Chargebee Inc.
 */

package com.chargebee.core.services;

import com.chargebee.client.ChargebeeClient;
import com.chargebee.client.request.RequestOptions;
import com.chargebee.transport.Response;

import com.chargebee.core.models.invoice.params.InvoiceDeleteLineItemsParams;

import com.chargebee.core.models.invoice.params.InvoiceRemoveCreditNoteParams;

import com.chargebee.core.models.invoice.params.InvoiceRemovePaymentParams;

import com.chargebee.core.models.invoice.params.InvoiceStopDunningParams;

import com.chargebee.core.models.invoice.params.InvoiceApplyPaymentsParams;

import com.chargebee.core.models.invoice.params.InvoiceApplyPaymentScheduleSchemeParams;

import com.chargebee.core.models.invoice.params.InvoiceVoidInvoiceParams;

import com.chargebee.core.models.invoice.params.InvoiceAddChargeParams;

import com.chargebee.core.models.invoice.params.InvoiceWriteOffParams;

import com.chargebee.core.models.invoice.params.InvoiceAddChargeItemParams;

import com.chargebee.core.models.invoice.params.InvoicePauseDunningParams;

import com.chargebee.core.models.invoice.params.InvoiceListParams;

import com.chargebee.core.models.invoice.params.InvoiceCreateParams;

import com.chargebee.core.models.invoice.params.InvoiceCloseParams;

import com.chargebee.core.models.invoice.params.InvoiceApplyCreditsParams;

import com.chargebee.core.models.invoice.params.InvoiceCreateForChargeItemParams;

import com.chargebee.core.models.invoice.params.InvoiceCreateForChargeItemsAndChargesParams;

import com.chargebee.core.models.invoice.params.InvoiceDeleteImportedParams;

import com.chargebee.core.models.invoice.params.InvoiceUpdateDetailsParams;

import com.chargebee.core.models.invoice.params.InvoiceInvoicesForCustomerParams;

import com.chargebee.core.models.invoice.params.InvoiceRecordPaymentParams;

import com.chargebee.core.models.invoice.params.InvoiceDeleteParams;

import com.chargebee.core.models.invoice.params.InvoiceImportInvoiceParams;

import com.chargebee.core.models.invoice.params.InvoiceResumeDunningParams;

import com.chargebee.core.models.invoice.params.InvoiceRecordTaxWithheldParams;

import com.chargebee.core.models.invoice.params.InvoiceRemoveTaxWithheldParams;

import com.chargebee.core.models.invoice.params.InvoiceListPaymentReferenceNumbersParams;

import com.chargebee.core.models.invoice.params.InvoiceCollectPaymentParams;

import com.chargebee.core.models.invoice.params.InvoiceRefundParams;

import com.chargebee.core.models.invoice.params.InvoiceRecordRefundParams;

import com.chargebee.core.models.invoice.params.InvoicePdfParams;

import com.chargebee.core.models.invoice.params.InvoiceInvoicesForSubscriptionParams;

import com.chargebee.core.models.invoice.params.InvoiceChargeAddonParams;

import com.chargebee.core.models.invoice.params.InvoiceAddAddonChargeParams;

import com.chargebee.core.models.invoice.params.InvoiceChargeParams;

import com.chargebee.core.responses.invoice.InvoiceDeleteLineItemsResponse;

import com.chargebee.core.responses.invoice.InvoiceRemoveCreditNoteResponse;

import com.chargebee.core.responses.invoice.InvoiceRemovePaymentResponse;

import com.chargebee.core.responses.invoice.InvoiceStopDunningResponse;

import com.chargebee.core.responses.invoice.InvoiceApplyPaymentsResponse;

import com.chargebee.core.responses.invoice.InvoiceApplyPaymentScheduleSchemeResponse;

import com.chargebee.core.responses.invoice.InvoiceVoidInvoiceResponse;

import com.chargebee.core.responses.invoice.InvoiceAddChargeResponse;

import com.chargebee.core.responses.invoice.InvoiceSendEinvoiceResponse;

import com.chargebee.core.responses.invoice.InvoicePaymentSchedulesResponse;

import com.chargebee.core.responses.invoice.InvoiceWriteOffResponse;

import com.chargebee.core.responses.invoice.InvoiceAddChargeItemResponse;

import com.chargebee.core.responses.invoice.InvoicePauseDunningResponse;

import com.chargebee.core.responses.invoice.InvoiceListResponse;

import com.chargebee.core.responses.invoice.InvoiceCreateResponse;

import com.chargebee.core.responses.invoice.InvoiceCloseResponse;

import com.chargebee.core.responses.invoice.InvoiceApplyCreditsResponse;

import com.chargebee.core.responses.invoice.InvoiceRetrieveResponse;

import com.chargebee.core.responses.invoice.InvoiceCreateForChargeItemResponse;

import com.chargebee.core.responses.invoice.InvoiceCreateForChargeItemsAndChargesResponse;

import com.chargebee.core.responses.invoice.InvoiceDeleteImportedResponse;

import com.chargebee.core.responses.invoice.InvoiceUpdateDetailsResponse;

import com.chargebee.core.responses.invoice.InvoiceInvoicesForCustomerResponse;

import com.chargebee.core.responses.invoice.InvoiceRecordPaymentResponse;

import com.chargebee.core.responses.invoice.InvoiceDeleteResponse;

import com.chargebee.core.responses.invoice.InvoiceImportInvoiceResponse;

import com.chargebee.core.responses.invoice.InvoiceResumeDunningResponse;

import com.chargebee.core.responses.invoice.InvoiceRecordTaxWithheldResponse;

import com.chargebee.core.responses.invoice.InvoiceResendEinvoiceResponse;

import com.chargebee.core.responses.invoice.InvoiceRemoveTaxWithheldResponse;

import com.chargebee.core.responses.invoice.InvoiceListPaymentReferenceNumbersResponse;

import com.chargebee.core.responses.invoice.InvoiceCollectPaymentResponse;

import com.chargebee.core.responses.invoice.InvoiceSyncUsagesResponse;

import com.chargebee.core.responses.invoice.InvoiceRefundResponse;

import com.chargebee.core.responses.invoice.InvoiceRecordRefundResponse;

import com.chargebee.core.responses.invoice.InvoicePdfResponse;

import com.chargebee.core.responses.invoice.InvoiceInvoicesForSubscriptionResponse;

import com.chargebee.core.responses.invoice.InvoiceDownloadEinvoiceResponse;

import com.chargebee.core.responses.invoice.InvoiceChargeAddonResponse;

import com.chargebee.core.responses.invoice.InvoiceAddAddonChargeResponse;

import com.chargebee.core.responses.invoice.InvoiceChargeResponse;

public final class InvoiceService extends BaseService<InvoiceService> {

  private final ServiceConfig config;

  public InvoiceService(ChargebeeClient client) {
    super(client);
    this.config = ServiceConfig.defaultConfig();
  }

  private InvoiceService(ChargebeeClient client, RequestOptions options) {
    super(client, options);
    this.config = ServiceConfig.defaultConfig();
  }

  private InvoiceService(ChargebeeClient client, RequestOptions options, ServiceConfig config) {
    super(client, options);
    this.config = config;
  }

  @Override
  InvoiceService with(RequestOptions newOptions) {
    return new InvoiceService(client, newOptions, config);
  }

  /**
   * Apply per-request options for this service instance. Users can chain .withOptions or .options
   * to set headers and other options.
   */
  public InvoiceService withOptions(RequestOptions options) {
    return with(options);
  }

  // === Operations ===

  /** deleteLineItems a invoice (executes immediately) - returns raw Response. */
  Response deleteLineItemsRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/delete_line_items", "invoice-id", invoiceId);

    return post(path, null);
  }

  /**
   * deleteLineItems a invoice using immutable params (executes immediately) - returns raw Response.
   */
  Response deleteLineItemsRaw(String invoiceId, InvoiceDeleteLineItemsParams params)
      throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/delete_line_items", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /**
   * deleteLineItems a invoice using raw JSON payload (executes immediately) - returns raw Response.
   */
  Response deleteLineItemsRaw(String invoiceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/delete_line_items", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceDeleteLineItemsResponse deleteLineItems(
      String invoiceId, InvoiceDeleteLineItemsParams params) throws Exception {
    Response response = deleteLineItemsRaw(invoiceId, params);
    return parseResponse(response, InvoiceDeleteLineItemsResponse.class);
  }

  /** removeCreditNote a invoice (executes immediately) - returns raw Response. */
  Response removeCreditNoteRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/remove_credit_note", "invoice-id", invoiceId);

    return post(path, null);
  }

  /**
   * removeCreditNote a invoice using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response removeCreditNoteRaw(String invoiceId, InvoiceRemoveCreditNoteParams params)
      throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/remove_credit_note", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /**
   * removeCreditNote a invoice using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response removeCreditNoteRaw(String invoiceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/remove_credit_note", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceRemoveCreditNoteResponse removeCreditNote(
      String invoiceId, InvoiceRemoveCreditNoteParams params) throws Exception {
    Response response = removeCreditNoteRaw(invoiceId, params);
    return parseResponse(response, InvoiceRemoveCreditNoteResponse.class);
  }

  /** removePayment a invoice (executes immediately) - returns raw Response. */
  Response removePaymentRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/remove_payment", "invoice-id", invoiceId);

    return post(path, null);
  }

  /**
   * removePayment a invoice using immutable params (executes immediately) - returns raw Response.
   */
  Response removePaymentRaw(String invoiceId, InvoiceRemovePaymentParams params) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/remove_payment", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /**
   * removePayment a invoice using raw JSON payload (executes immediately) - returns raw Response.
   */
  Response removePaymentRaw(String invoiceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/remove_payment", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceRemovePaymentResponse removePayment(
      String invoiceId, InvoiceRemovePaymentParams params) throws Exception {
    Response response = removePaymentRaw(invoiceId, params);
    return parseResponse(response, InvoiceRemovePaymentResponse.class);
  }

  /** stopDunning a invoice (executes immediately) - returns raw Response. */
  Response stopDunningRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/stop_dunning", "invoice-id", invoiceId);

    return post(path, null);
  }

  /** stopDunning a invoice using immutable params (executes immediately) - returns raw Response. */
  Response stopDunningRaw(String invoiceId, InvoiceStopDunningParams params) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/stop_dunning", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /** stopDunning a invoice using raw JSON payload (executes immediately) - returns raw Response. */
  Response stopDunningRaw(String invoiceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/stop_dunning", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceStopDunningResponse stopDunning(String invoiceId, InvoiceStopDunningParams params)
      throws Exception {
    Response response = stopDunningRaw(invoiceId, params);
    return parseResponse(response, InvoiceStopDunningResponse.class);
  }

  /** applyPayments a invoice (executes immediately) - returns raw Response. */
  Response applyPaymentsRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/apply_payments", "invoice-id", invoiceId);

    return post(path, null);
  }

  /**
   * applyPayments a invoice using immutable params (executes immediately) - returns raw Response.
   */
  Response applyPaymentsRaw(String invoiceId, InvoiceApplyPaymentsParams params) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/apply_payments", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /**
   * applyPayments a invoice using raw JSON payload (executes immediately) - returns raw Response.
   */
  Response applyPaymentsRaw(String invoiceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/apply_payments", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceApplyPaymentsResponse applyPayments(
      String invoiceId, InvoiceApplyPaymentsParams params) throws Exception {
    Response response = applyPaymentsRaw(invoiceId, params);
    return parseResponse(response, InvoiceApplyPaymentsResponse.class);
  }

  /** applyPaymentScheduleScheme a invoice (executes immediately) - returns raw Response. */
  Response applyPaymentScheduleSchemeRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams(
            "/invoices/{invoice-id}/apply_payment_schedule_scheme", "invoice-id", invoiceId);

    return post(path, null);
  }

  /**
   * applyPaymentScheduleScheme a invoice using immutable params (executes immediately) - returns
   * raw Response.
   */
  Response applyPaymentScheduleSchemeRaw(
      String invoiceId, InvoiceApplyPaymentScheduleSchemeParams params) throws Exception {
    String path =
        buildPathWithParams(
            "/invoices/{invoice-id}/apply_payment_schedule_scheme", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /**
   * applyPaymentScheduleScheme a invoice using raw JSON payload (executes immediately) - returns
   * raw Response.
   */
  Response applyPaymentScheduleSchemeRaw(String invoiceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams(
            "/invoices/{invoice-id}/apply_payment_schedule_scheme", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceApplyPaymentScheduleSchemeResponse applyPaymentScheduleScheme(
      String invoiceId, InvoiceApplyPaymentScheduleSchemeParams params) throws Exception {
    Response response = applyPaymentScheduleSchemeRaw(invoiceId, params);
    return parseResponse(response, InvoiceApplyPaymentScheduleSchemeResponse.class);
  }

  /** voidInvoice a invoice (executes immediately) - returns raw Response. */
  Response voidInvoiceRaw(String invoiceId) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/void", "invoice-id", invoiceId);

    return post(path, null);
  }

  /** voidInvoice a invoice using immutable params (executes immediately) - returns raw Response. */
  Response voidInvoiceRaw(String invoiceId, InvoiceVoidInvoiceParams params) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/void", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /** voidInvoice a invoice using raw JSON payload (executes immediately) - returns raw Response. */
  Response voidInvoiceRaw(String invoiceId, String jsonPayload) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/void", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceVoidInvoiceResponse voidInvoice(String invoiceId, InvoiceVoidInvoiceParams params)
      throws Exception {
    Response response = voidInvoiceRaw(invoiceId, params);
    return parseResponse(response, InvoiceVoidInvoiceResponse.class);
  }

  /** addCharge a invoice (executes immediately) - returns raw Response. */
  Response addChargeRaw(String invoiceId) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/add_charge", "invoice-id", invoiceId);

    return post(path, null);
  }

  /** addCharge a invoice using immutable params (executes immediately) - returns raw Response. */
  Response addChargeRaw(String invoiceId, InvoiceAddChargeParams params) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/add_charge", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /** addCharge a invoice using raw JSON payload (executes immediately) - returns raw Response. */
  Response addChargeRaw(String invoiceId, String jsonPayload) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/add_charge", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceAddChargeResponse addCharge(String invoiceId, InvoiceAddChargeParams params)
      throws Exception {
    Response response = addChargeRaw(invoiceId, params);
    return parseResponse(response, InvoiceAddChargeResponse.class);
  }

  /** sendEinvoice a invoice (executes immediately) - returns raw Response. */
  Response sendEinvoiceRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/send_einvoice", "invoice-id", invoiceId);

    return post(path, null);
  }

  public InvoiceSendEinvoiceResponse sendEinvoice(String invoiceId) throws Exception {
    Response response = sendEinvoiceRaw(invoiceId);
    return parseResponse(response, InvoiceSendEinvoiceResponse.class);
  }

  /** paymentSchedules a invoice (executes immediately) - returns raw Response. */
  Response paymentSchedulesRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/payment_schedules", "invoice-id", invoiceId);

    return get(path, null);
  }

  public InvoicePaymentSchedulesResponse paymentSchedules(String invoiceId) throws Exception {
    Response response = paymentSchedulesRaw(invoiceId);
    return parseResponse(response, InvoicePaymentSchedulesResponse.class);
  }

  /** writeOff a invoice (executes immediately) - returns raw Response. */
  Response writeOffRaw(String invoiceId) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/write_off", "invoice-id", invoiceId);

    return post(path, null);
  }

  /** writeOff a invoice using immutable params (executes immediately) - returns raw Response. */
  Response writeOffRaw(String invoiceId, InvoiceWriteOffParams params) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/write_off", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /** writeOff a invoice using raw JSON payload (executes immediately) - returns raw Response. */
  Response writeOffRaw(String invoiceId, String jsonPayload) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/write_off", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceWriteOffResponse writeOff(String invoiceId, InvoiceWriteOffParams params)
      throws Exception {
    Response response = writeOffRaw(invoiceId, params);
    return parseResponse(response, InvoiceWriteOffResponse.class);
  }

  /** addChargeItem a invoice (executes immediately) - returns raw Response. */
  Response addChargeItemRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/add_charge_item", "invoice-id", invoiceId);

    return post(path, null);
  }

  /**
   * addChargeItem a invoice using immutable params (executes immediately) - returns raw Response.
   */
  Response addChargeItemRaw(String invoiceId, InvoiceAddChargeItemParams params) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/add_charge_item", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /**
   * addChargeItem a invoice using raw JSON payload (executes immediately) - returns raw Response.
   */
  Response addChargeItemRaw(String invoiceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/add_charge_item", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceAddChargeItemResponse addChargeItem(
      String invoiceId, InvoiceAddChargeItemParams params) throws Exception {
    Response response = addChargeItemRaw(invoiceId, params);
    return parseResponse(response, InvoiceAddChargeItemResponse.class);
  }

  /** pauseDunning a invoice (executes immediately) - returns raw Response. */
  Response pauseDunningRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/pause_dunning", "invoice-id", invoiceId);

    return post(path, null);
  }

  /**
   * pauseDunning a invoice using immutable params (executes immediately) - returns raw Response.
   */
  Response pauseDunningRaw(String invoiceId, InvoicePauseDunningParams params) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/pause_dunning", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /**
   * pauseDunning a invoice using raw JSON payload (executes immediately) - returns raw Response.
   */
  Response pauseDunningRaw(String invoiceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/pause_dunning", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoicePauseDunningResponse pauseDunning(
      String invoiceId, InvoicePauseDunningParams params) throws Exception {
    Response response = pauseDunningRaw(invoiceId, params);
    return parseResponse(response, InvoicePauseDunningResponse.class);
  }

  /** list a invoice using immutable params (executes immediately) - returns raw Response. */
  Response listRaw(InvoiceListParams params) throws Exception {

    return get("/invoices", params != null ? params.toQueryParams() : null);
  }

  /** list a invoice without params (executes immediately) - returns raw Response. */
  Response listRaw() throws Exception {

    return get("/invoices", null);
  }

  /** list a invoice using raw JSON payload (executes immediately) - returns raw Response. */
  Response listRaw(String jsonPayload) throws Exception {

    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public InvoiceListResponse list(InvoiceListParams params) throws Exception {
    Response response = listRaw(params);

    return InvoiceListResponse.fromJson(response.getBodyAsString(), this, params);
  }

  public InvoiceListResponse list() throws Exception {
    Response response = listRaw();
    return InvoiceListResponse.fromJson(response.getBodyAsString(), this, null);
  }

  /** create a invoice using immutable params (executes immediately) - returns raw Response. */
  Response createRaw(InvoiceCreateParams params) throws Exception {

    return post("/invoices", params != null ? params.toFormData() : null);
  }

  /** create a invoice using raw JSON payload (executes immediately) - returns raw Response. */
  Response createRaw(String jsonPayload) throws Exception {

    return postJson("/invoices", jsonPayload);
  }

  public InvoiceCreateResponse create(InvoiceCreateParams params) throws Exception {
    Response response = createRaw(params);

    return parseResponse(response, InvoiceCreateResponse.class);
  }

  /** close a invoice (executes immediately) - returns raw Response. */
  Response closeRaw(String invoiceId) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/close", "invoice-id", invoiceId);

    return post(path, null);
  }

  /** close a invoice using immutable params (executes immediately) - returns raw Response. */
  Response closeRaw(String invoiceId, InvoiceCloseParams params) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/close", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /** close a invoice using raw JSON payload (executes immediately) - returns raw Response. */
  Response closeRaw(String invoiceId, String jsonPayload) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/close", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceCloseResponse close(String invoiceId, InvoiceCloseParams params) throws Exception {
    Response response = closeRaw(invoiceId, params);
    return parseResponse(response, InvoiceCloseResponse.class);
  }

  /** applyCredits a invoice (executes immediately) - returns raw Response. */
  Response applyCreditsRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/apply_credits", "invoice-id", invoiceId);

    return post(path, null);
  }

  /**
   * applyCredits a invoice using immutable params (executes immediately) - returns raw Response.
   */
  Response applyCreditsRaw(String invoiceId, InvoiceApplyCreditsParams params) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/apply_credits", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /**
   * applyCredits a invoice using raw JSON payload (executes immediately) - returns raw Response.
   */
  Response applyCreditsRaw(String invoiceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/apply_credits", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceApplyCreditsResponse applyCredits(
      String invoiceId, InvoiceApplyCreditsParams params) throws Exception {
    Response response = applyCreditsRaw(invoiceId, params);
    return parseResponse(response, InvoiceApplyCreditsResponse.class);
  }

  /** retrieve a invoice (executes immediately) - returns raw Response. */
  Response retrieveRaw(String invoiceId) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}", "invoice-id", invoiceId);

    return get(path, null);
  }

  public InvoiceRetrieveResponse retrieve(String invoiceId) throws Exception {
    Response response = retrieveRaw(invoiceId);
    return parseResponse(response, InvoiceRetrieveResponse.class);
  }

  /**
   * createForChargeItem a invoice using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response createForChargeItemRaw(InvoiceCreateForChargeItemParams params) throws Exception {

    return post("/invoices/create_for_charge_item", params != null ? params.toFormData() : null);
  }

  /**
   * createForChargeItem a invoice using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response createForChargeItemRaw(String jsonPayload) throws Exception {

    return postJson("/invoices/create_for_charge_item", jsonPayload);
  }

  public InvoiceCreateForChargeItemResponse createForChargeItem(
      InvoiceCreateForChargeItemParams params) throws Exception {
    Response response = createForChargeItemRaw(params);

    return parseResponse(response, InvoiceCreateForChargeItemResponse.class);
  }

  /**
   * createForChargeItemsAndCharges a invoice using immutable params (executes immediately) -
   * returns raw Response.
   */
  Response createForChargeItemsAndChargesRaw(InvoiceCreateForChargeItemsAndChargesParams params)
      throws Exception {

    return post(
        "/invoices/create_for_charge_items_and_charges",
        params != null ? params.toFormData() : null);
  }

  /**
   * createForChargeItemsAndCharges a invoice using raw JSON payload (executes immediately) -
   * returns raw Response.
   */
  Response createForChargeItemsAndChargesRaw(String jsonPayload) throws Exception {

    return postJson("/invoices/create_for_charge_items_and_charges", jsonPayload);
  }

  public InvoiceCreateForChargeItemsAndChargesResponse createForChargeItemsAndCharges(
      InvoiceCreateForChargeItemsAndChargesParams params) throws Exception {
    Response response = createForChargeItemsAndChargesRaw(params);

    return parseResponse(response, InvoiceCreateForChargeItemsAndChargesResponse.class);
  }

  /** deleteImported a invoice (executes immediately) - returns raw Response. */
  Response deleteImportedRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/delete_imported", "invoice-id", invoiceId);

    return post(path, null);
  }

  /**
   * deleteImported a invoice using immutable params (executes immediately) - returns raw Response.
   */
  Response deleteImportedRaw(String invoiceId, InvoiceDeleteImportedParams params)
      throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/delete_imported", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /**
   * deleteImported a invoice using raw JSON payload (executes immediately) - returns raw Response.
   */
  Response deleteImportedRaw(String invoiceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/delete_imported", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceDeleteImportedResponse deleteImported(
      String invoiceId, InvoiceDeleteImportedParams params) throws Exception {
    Response response = deleteImportedRaw(invoiceId, params);
    return parseResponse(response, InvoiceDeleteImportedResponse.class);
  }

  /** updateDetails a invoice (executes immediately) - returns raw Response. */
  Response updateDetailsRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/update_details", "invoice-id", invoiceId);

    return post(path, null);
  }

  /**
   * updateDetails a invoice using immutable params (executes immediately) - returns raw Response.
   */
  Response updateDetailsRaw(String invoiceId, InvoiceUpdateDetailsParams params) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/update_details", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /**
   * updateDetails a invoice using raw JSON payload (executes immediately) - returns raw Response.
   */
  Response updateDetailsRaw(String invoiceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/update_details", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceUpdateDetailsResponse updateDetails(
      String invoiceId, InvoiceUpdateDetailsParams params) throws Exception {
    Response response = updateDetailsRaw(invoiceId, params);
    return parseResponse(response, InvoiceUpdateDetailsResponse.class);
  }

  /**
   * invoicesForCustomer a invoice using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response invoicesForCustomerRaw(String customerId, InvoiceInvoicesForCustomerParams params)
      throws Exception {
    String path =
        buildPathWithParams("/customers/{customer-id}/invoices", "customer-id", customerId);
    return get(path, params != null ? params.toQueryParams() : null);
  }

  /** invoicesForCustomer a invoice without params (executes immediately) - returns raw Response. */
  Response invoicesForCustomerRaw(String customerId) throws Exception {
    String path =
        buildPathWithParams("/customers/{customer-id}/invoices", "customer-id", customerId);
    return get(path, null);
  }

  /**
   * invoicesForCustomer a invoice using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response invoicesForCustomerRaw(String customerId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/customers/{customer-id}/invoices", "customer-id", customerId);
    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public InvoiceInvoicesForCustomerResponse invoicesForCustomer(
      String customerId, InvoiceInvoicesForCustomerParams params) throws Exception {
    Response response = invoicesForCustomerRaw(customerId, params);
    return InvoiceInvoicesForCustomerResponse.fromJson(
        response.getBodyAsString(), this, params, customerId);
  }

  public InvoiceInvoicesForCustomerResponse invoicesForCustomer(String customerId)
      throws Exception {
    Response response = invoicesForCustomerRaw(customerId);
    return InvoiceInvoicesForCustomerResponse.fromJson(
        response.getBodyAsString(), this, null, customerId);
  }

  /** recordPayment a invoice (executes immediately) - returns raw Response. */
  Response recordPaymentRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/record_payment", "invoice-id", invoiceId);

    return post(path, null);
  }

  /**
   * recordPayment a invoice using immutable params (executes immediately) - returns raw Response.
   */
  Response recordPaymentRaw(String invoiceId, InvoiceRecordPaymentParams params) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/record_payment", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /**
   * recordPayment a invoice using raw JSON payload (executes immediately) - returns raw Response.
   */
  Response recordPaymentRaw(String invoiceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/record_payment", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceRecordPaymentResponse recordPayment(
      String invoiceId, InvoiceRecordPaymentParams params) throws Exception {
    Response response = recordPaymentRaw(invoiceId, params);
    return parseResponse(response, InvoiceRecordPaymentResponse.class);
  }

  /** delete a invoice (executes immediately) - returns raw Response. */
  Response deleteRaw(String invoiceId) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/delete", "invoice-id", invoiceId);

    return post(path, null);
  }

  /** delete a invoice using immutable params (executes immediately) - returns raw Response. */
  Response deleteRaw(String invoiceId, InvoiceDeleteParams params) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/delete", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /** delete a invoice using raw JSON payload (executes immediately) - returns raw Response. */
  Response deleteRaw(String invoiceId, String jsonPayload) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/delete", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceDeleteResponse delete(String invoiceId, InvoiceDeleteParams params)
      throws Exception {
    Response response = deleteRaw(invoiceId, params);
    return parseResponse(response, InvoiceDeleteResponse.class);
  }

  /**
   * importInvoice a invoice using immutable params (executes immediately) - returns raw Response.
   */
  Response importInvoiceRaw(InvoiceImportInvoiceParams params) throws Exception {

    return post("/invoices/import_invoice", params != null ? params.toFormData() : null);
  }

  /**
   * importInvoice a invoice using raw JSON payload (executes immediately) - returns raw Response.
   */
  Response importInvoiceRaw(String jsonPayload) throws Exception {

    return postJson("/invoices/import_invoice", jsonPayload);
  }

  public InvoiceImportInvoiceResponse importInvoice(InvoiceImportInvoiceParams params)
      throws Exception {
    Response response = importInvoiceRaw(params);

    return parseResponse(response, InvoiceImportInvoiceResponse.class);
  }

  /** resumeDunning a invoice (executes immediately) - returns raw Response. */
  Response resumeDunningRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/resume_dunning", "invoice-id", invoiceId);

    return post(path, null);
  }

  /**
   * resumeDunning a invoice using immutable params (executes immediately) - returns raw Response.
   */
  Response resumeDunningRaw(String invoiceId, InvoiceResumeDunningParams params) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/resume_dunning", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /**
   * resumeDunning a invoice using raw JSON payload (executes immediately) - returns raw Response.
   */
  Response resumeDunningRaw(String invoiceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/resume_dunning", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceResumeDunningResponse resumeDunning(
      String invoiceId, InvoiceResumeDunningParams params) throws Exception {
    Response response = resumeDunningRaw(invoiceId, params);
    return parseResponse(response, InvoiceResumeDunningResponse.class);
  }

  /** recordTaxWithheld a invoice (executes immediately) - returns raw Response. */
  Response recordTaxWithheldRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/record_tax_withheld", "invoice-id", invoiceId);

    return post(path, null);
  }

  /**
   * recordTaxWithheld a invoice using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response recordTaxWithheldRaw(String invoiceId, InvoiceRecordTaxWithheldParams params)
      throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/record_tax_withheld", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /**
   * recordTaxWithheld a invoice using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response recordTaxWithheldRaw(String invoiceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/record_tax_withheld", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceRecordTaxWithheldResponse recordTaxWithheld(
      String invoiceId, InvoiceRecordTaxWithheldParams params) throws Exception {
    Response response = recordTaxWithheldRaw(invoiceId, params);
    return parseResponse(response, InvoiceRecordTaxWithheldResponse.class);
  }

  /** resendEinvoice a invoice (executes immediately) - returns raw Response. */
  Response resendEinvoiceRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/resend_einvoice", "invoice-id", invoiceId);

    return post(path, null);
  }

  public InvoiceResendEinvoiceResponse resendEinvoice(String invoiceId) throws Exception {
    Response response = resendEinvoiceRaw(invoiceId);
    return parseResponse(response, InvoiceResendEinvoiceResponse.class);
  }

  /** removeTaxWithheld a invoice (executes immediately) - returns raw Response. */
  Response removeTaxWithheldRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/remove_tax_withheld", "invoice-id", invoiceId);

    return post(path, null);
  }

  /**
   * removeTaxWithheld a invoice using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response removeTaxWithheldRaw(String invoiceId, InvoiceRemoveTaxWithheldParams params)
      throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/remove_tax_withheld", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /**
   * removeTaxWithheld a invoice using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response removeTaxWithheldRaw(String invoiceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/remove_tax_withheld", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceRemoveTaxWithheldResponse removeTaxWithheld(
      String invoiceId, InvoiceRemoveTaxWithheldParams params) throws Exception {
    Response response = removeTaxWithheldRaw(invoiceId, params);
    return parseResponse(response, InvoiceRemoveTaxWithheldResponse.class);
  }

  /**
   * listPaymentReferenceNumbers a invoice using immutable params (executes immediately) - returns
   * raw Response.
   */
  Response listPaymentReferenceNumbersRaw(InvoiceListPaymentReferenceNumbersParams params)
      throws Exception {

    return get(
        "/invoices/payment_reference_numbers", params != null ? params.toQueryParams() : null);
  }

  /**
   * listPaymentReferenceNumbers a invoice without params (executes immediately) - returns raw
   * Response.
   */
  Response listPaymentReferenceNumbersRaw() throws Exception {

    return get("/invoices/payment_reference_numbers", null);
  }

  /**
   * listPaymentReferenceNumbers a invoice using raw JSON payload (executes immediately) - returns
   * raw Response.
   */
  Response listPaymentReferenceNumbersRaw(String jsonPayload) throws Exception {

    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public InvoiceListPaymentReferenceNumbersResponse listPaymentReferenceNumbers(
      InvoiceListPaymentReferenceNumbersParams params) throws Exception {
    Response response = listPaymentReferenceNumbersRaw(params);

    return InvoiceListPaymentReferenceNumbersResponse.fromJson(
        response.getBodyAsString(), this, params);
  }

  public InvoiceListPaymentReferenceNumbersResponse listPaymentReferenceNumbers() throws Exception {
    Response response = listPaymentReferenceNumbersRaw();
    return InvoiceListPaymentReferenceNumbersResponse.fromJson(
        response.getBodyAsString(), this, null);
  }

  /** collectPayment a invoice (executes immediately) - returns raw Response. */
  Response collectPaymentRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/collect_payment", "invoice-id", invoiceId);

    return post(path, null);
  }

  /**
   * collectPayment a invoice using immutable params (executes immediately) - returns raw Response.
   */
  Response collectPaymentRaw(String invoiceId, InvoiceCollectPaymentParams params)
      throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/collect_payment", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /**
   * collectPayment a invoice using raw JSON payload (executes immediately) - returns raw Response.
   */
  Response collectPaymentRaw(String invoiceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/collect_payment", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceCollectPaymentResponse collectPayment(
      String invoiceId, InvoiceCollectPaymentParams params) throws Exception {
    Response response = collectPaymentRaw(invoiceId, params);
    return parseResponse(response, InvoiceCollectPaymentResponse.class);
  }

  /** syncUsages a invoice (executes immediately) - returns raw Response. */
  Response syncUsagesRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/sync_usages", "invoice-id", invoiceId);

    return post(path, null);
  }

  public InvoiceSyncUsagesResponse syncUsages(String invoiceId) throws Exception {
    Response response = syncUsagesRaw(invoiceId);
    return parseResponse(response, InvoiceSyncUsagesResponse.class);
  }

  /** refund a invoice (executes immediately) - returns raw Response. */
  Response refundRaw(String invoiceId) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/refund", "invoice-id", invoiceId);

    return post(path, null);
  }

  /** refund a invoice using immutable params (executes immediately) - returns raw Response. */
  Response refundRaw(String invoiceId, InvoiceRefundParams params) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/refund", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /** refund a invoice using raw JSON payload (executes immediately) - returns raw Response. */
  Response refundRaw(String invoiceId, String jsonPayload) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/refund", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceRefundResponse refund(String invoiceId, InvoiceRefundParams params)
      throws Exception {
    Response response = refundRaw(invoiceId, params);
    return parseResponse(response, InvoiceRefundResponse.class);
  }

  /** recordRefund a invoice (executes immediately) - returns raw Response. */
  Response recordRefundRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/record_refund", "invoice-id", invoiceId);

    return post(path, null);
  }

  /**
   * recordRefund a invoice using immutable params (executes immediately) - returns raw Response.
   */
  Response recordRefundRaw(String invoiceId, InvoiceRecordRefundParams params) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/record_refund", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /**
   * recordRefund a invoice using raw JSON payload (executes immediately) - returns raw Response.
   */
  Response recordRefundRaw(String invoiceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/record_refund", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceRecordRefundResponse recordRefund(
      String invoiceId, InvoiceRecordRefundParams params) throws Exception {
    Response response = recordRefundRaw(invoiceId, params);
    return parseResponse(response, InvoiceRecordRefundResponse.class);
  }

  /** pdf a invoice (executes immediately) - returns raw Response. */
  Response pdfRaw(String invoiceId) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/pdf", "invoice-id", invoiceId);

    return post(path, null);
  }

  /** pdf a invoice using immutable params (executes immediately) - returns raw Response. */
  Response pdfRaw(String invoiceId, InvoicePdfParams params) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/pdf", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /** pdf a invoice using raw JSON payload (executes immediately) - returns raw Response. */
  Response pdfRaw(String invoiceId, String jsonPayload) throws Exception {
    String path = buildPathWithParams("/invoices/{invoice-id}/pdf", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoicePdfResponse pdf(String invoiceId, InvoicePdfParams params) throws Exception {
    Response response = pdfRaw(invoiceId, params);
    return parseResponse(response, InvoicePdfResponse.class);
  }

  /**
   * invoicesForSubscription a invoice using immutable params (executes immediately) - returns raw
   * Response.
   */
  Response invoicesForSubscriptionRaw(
      String subscriptionId, InvoiceInvoicesForSubscriptionParams params) throws Exception {
    String path =
        buildPathWithParams(
            "/subscriptions/{subscription-id}/invoices", "subscription-id", subscriptionId);
    return get(path, params != null ? params.toQueryParams() : null);
  }

  /**
   * invoicesForSubscription a invoice without params (executes immediately) - returns raw Response.
   */
  Response invoicesForSubscriptionRaw(String subscriptionId) throws Exception {
    String path =
        buildPathWithParams(
            "/subscriptions/{subscription-id}/invoices", "subscription-id", subscriptionId);
    return get(path, null);
  }

  /**
   * invoicesForSubscription a invoice using raw JSON payload (executes immediately) - returns raw
   * Response.
   */
  Response invoicesForSubscriptionRaw(String subscriptionId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams(
            "/subscriptions/{subscription-id}/invoices", "subscription-id", subscriptionId);
    throw new UnsupportedOperationException("JSON payload not supported for GET operations");
  }

  public InvoiceInvoicesForSubscriptionResponse invoicesForSubscription(
      String subscriptionId, InvoiceInvoicesForSubscriptionParams params) throws Exception {
    Response response = invoicesForSubscriptionRaw(subscriptionId, params);
    return InvoiceInvoicesForSubscriptionResponse.fromJson(
        response.getBodyAsString(), this, params, subscriptionId);
  }

  public InvoiceInvoicesForSubscriptionResponse invoicesForSubscription(String subscriptionId)
      throws Exception {
    Response response = invoicesForSubscriptionRaw(subscriptionId);
    return InvoiceInvoicesForSubscriptionResponse.fromJson(
        response.getBodyAsString(), this, null, subscriptionId);
  }

  /** downloadEinvoice a invoice (executes immediately) - returns raw Response. */
  Response downloadEinvoiceRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/download_einvoice", "invoice-id", invoiceId);

    return get(path, null);
  }

  public InvoiceDownloadEinvoiceResponse downloadEinvoice(String invoiceId) throws Exception {
    Response response = downloadEinvoiceRaw(invoiceId);
    return parseResponse(response, InvoiceDownloadEinvoiceResponse.class);
  }

  /** chargeAddon a invoice using immutable params (executes immediately) - returns raw Response. */
  Response chargeAddonRaw(InvoiceChargeAddonParams params) throws Exception {

    return post("/invoices/charge_addon", params != null ? params.toFormData() : null);
  }

  /** chargeAddon a invoice using raw JSON payload (executes immediately) - returns raw Response. */
  Response chargeAddonRaw(String jsonPayload) throws Exception {

    return postJson("/invoices/charge_addon", jsonPayload);
  }

  public InvoiceChargeAddonResponse chargeAddon(InvoiceChargeAddonParams params) throws Exception {
    Response response = chargeAddonRaw(params);

    return parseResponse(response, InvoiceChargeAddonResponse.class);
  }

  /** addAddonCharge a invoice (executes immediately) - returns raw Response. */
  Response addAddonChargeRaw(String invoiceId) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/add_addon_charge", "invoice-id", invoiceId);

    return post(path, null);
  }

  /**
   * addAddonCharge a invoice using immutable params (executes immediately) - returns raw Response.
   */
  Response addAddonChargeRaw(String invoiceId, InvoiceAddAddonChargeParams params)
      throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/add_addon_charge", "invoice-id", invoiceId);
    return post(path, params.toFormData());
  }

  /**
   * addAddonCharge a invoice using raw JSON payload (executes immediately) - returns raw Response.
   */
  Response addAddonChargeRaw(String invoiceId, String jsonPayload) throws Exception {
    String path =
        buildPathWithParams("/invoices/{invoice-id}/add_addon_charge", "invoice-id", invoiceId);
    return postJson(path, jsonPayload);
  }

  public InvoiceAddAddonChargeResponse addAddonCharge(
      String invoiceId, InvoiceAddAddonChargeParams params) throws Exception {
    Response response = addAddonChargeRaw(invoiceId, params);
    return parseResponse(response, InvoiceAddAddonChargeResponse.class);
  }

  /** charge a invoice using immutable params (executes immediately) - returns raw Response. */
  Response chargeRaw(InvoiceChargeParams params) throws Exception {

    return post("/invoices/charge", params != null ? params.toFormData() : null);
  }

  /** charge a invoice using raw JSON payload (executes immediately) - returns raw Response. */
  Response chargeRaw(String jsonPayload) throws Exception {

    return postJson("/invoices/charge", jsonPayload);
  }

  public InvoiceChargeResponse charge(InvoiceChargeParams params) throws Exception {
    Response response = chargeRaw(params);

    return parseResponse(response, InvoiceChargeResponse.class);
  }
}
